(()=>{var R=Object.defineProperty;var W=Object.getOwnPropertySymbols;var L=Object.prototype.hasOwnProperty,N=Object.prototype.propertyIsEnumerable;var A=Math.pow,H=(e,s,o)=>s in e?R(e,s,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[s]=o,j=(e,s)=>{for(var o in s||(s={}))L.call(s,o)&&H(e,o,s[o]);if(W)for(var o of W(s))N.call(s,o)&&H(e,o,s[o]);return e};typeof PhpDebugBar=="undefined"&&(window.PhpDebugBar={},PhpDebugBar.$=jQuery);(function(e){typeof PhpDebugBar.utils=="undefined"&&(PhpDebugBar.utils={});const s=PhpDebugBar.utils.getDictValue=function(t,a,n){if(t==null)return n;const b=String(a).split(".");let x=t;for(const D of b)if(x==null||(x=x[D],x===void 0))return n;return x};PhpDebugBar.utils.csscls=function(t,a){const n=String(t).trim();return n.includes(" ")?n.split(/\s+/).filter(Boolean).map(b=>PhpDebugBar.utils.csscls(b,a)).join(" "):n.startsWith(".")?`.${a}${n.slice(1)}`:a+n},PhpDebugBar.utils.makecsscls=function(t){return a=>PhpDebugBar.utils.csscls(a,t)};const o=PhpDebugBar.utils.makecsscls("phpdebugbar-");class h{constructor(a={}){this._attributes=j({},this.defaults),this._boundAttributes={},this.$el=e(`<${this.tagName} />`),this.className&&this.$el.addClass(this.className),this.initialize(a),this.render()}initialize(a){this.set(a)}render(){}set(a,n){if(typeof a!="string"){for(const b in a)this.set(b,a[b]);return}if(this._attributes[a]=n,this._boundAttributes[a])for(const b of this._boundAttributes[a])b.call(this,n)}has(a){return this._attributes[a]!==void 0&&this._attributes[a]!==null}get(a){return this._attributes[a]}bindAttr(a,n){if(Array.isArray(a)){for(const b of a)this.bindAttr(b,n);return}if(this._boundAttributes[a]||(this._boundAttributes[a]=[]),typeof n=="object"){const b=n;n=x=>b.text(x||"")}this._boundAttributes[a].push(n),this.has(a)&&n.call(this,this._attributes[a])}static extend(a){const n=this;class b extends n{}return Object.assign(b.prototype,a),Object.assign(b,n),b.__super__=n.prototype,b}}h.prototype.tagName="div",h.prototype.className=null,h.prototype.defaults={},PhpDebugBar.Widget=h;const c=h.extend({className:o("panel"),render(){this.$tab=e("<a />").addClass(o("tab")),this.$icon=e("<i />").appendTo(this.$tab),this.bindAttr("icon",function(t){t?this.$icon.attr("class",`phpdebugbar-icon phpdebugbar-icon-${t}`):this.$icon.attr("class","")}),this.bindAttr("title",e("<span />").addClass(o("text")).appendTo(this.$tab)),this.$badge=e("<span />").addClass(o("badge")).appendTo(this.$tab),this.bindAttr("badge",function(t){t!==null?(this.$badge.text(t),this.$badge.addClass(o("visible"))):this.$badge.removeClass(o("visible"))}),this.bindAttr("widget",function(t){this.$el.empty().append(t.$el)}),this.bindAttr("data",function(t){this.has("widget")&&(this.get("widget").set("data",t),this.$tab.attr("data-empty",e.isEmptyObject(t)||t.count===0))})}}),l=h.extend({tagName:"span",className:o("indicator"),render(){this.$icon=e("<i />").appendTo(this.$el),this.bindAttr("icon",function(t){t?this.$icon.attr("class",`phpdebugbar-icon phpdebugbar-icon-${t}`):this.$icon.attr("class","")}),this.bindAttr("link",function(t){t?this.$el.on("click",()=>{this.get("debugbar").showTab(t)}).css("cursor","pointer"):this.$el.off("click",!1).css("cursor","")}),this.bindAttr(["title","data"],e("<span />").addClass(o("text")).appendTo(this.$el)),this.$tooltip=e("<span />").addClass(o("tooltip disabled")).appendTo(this.$el),this.bindAttr("tooltip",function(t){if(t){const a=e("<dl />");Array.isArray(t)||typeof t=="object"?(e.each(t,(n,b)=>{e("<dt />").text(n).appendTo(a),e("<dd />").text(b).appendTo(a)}),this.$tooltip.html(a).removeClass(o("disabled"))):this.$tooltip.text(t).removeClass(o("disabled"))}else this.$tooltip.addClass(o("disabled"))})}}),p=h.extend({tagName:"form",className:o("settings"),settings:{},initialize(t){this.set(t);const a=this.get("debugbar");this.settings=JSON.parse(localStorage.getItem("phpdebugbar-settings"))||{};for(const n in a.options)n in this.settings&&(a.options[n]=this.settings[n]),n==="theme"?a.setTheme(a.options[n]):a.$el.attr(`data-${n}`,a.options[n])},clearSettings(){const t=this.get("debugbar");if(localStorage.removeItem("phpdebugbar-settings"),localStorage.removeItem("phpdebugbar-ajaxhandler-autoshow"),this.settings={},t.options=j({},t.defaultOptions),t.ajaxHandler){const a=t.ajaxHandler.defaultAutoShow;t.ajaxHandler.setAutoShow(a),this.set("autoshow",a),t.controls.__datasets&&t.controls.__datasets.get("widget").set("autoshow",e(this).is(":checked"))}this.initialize(t.options)},storeSetting(t,a){this.settings[t]=a;const n=this.get("debugbar");n.options[t]=a,t!=="theme"&&n.$el.attr(`data-${t}`,a),localStorage.setItem("phpdebugbar-settings",JSON.stringify(this.settings))},render(){this.$el.empty();const t=this.get("debugbar"),a=this,n={};n.Theme=e('<select><option value="auto">Auto (System preference)</option><option value="light">Light</option><option value="dark">Dark</option></select>').val(t.options.theme).on("change",function(){a.storeSetting("theme",e(this).val()),t.setTheme(e(this).val())}),n["Open Button Position"]=e('<select><option value="bottomLeft">Bottom Left</option><option value="bottomRight">Bottom Right</option><option value="topLeft">Top Left</option><option value="topRight">Top Right</option></select>').val(t.options.openBtnPosition).on("change",function(){a.storeSetting("openBtnPosition",e(this).val())}),this.$hideEmptyTabs=e("<input type=checkbox>").prop("checked",t.options.hideEmptyTabs).on("click",function(){a.storeSetting("hideEmptyTabs",e(this).is(":checked"))}),n["Hide Empty Tabs"]=e("<label/>").append(this.$hideEmptyTabs,"Hide empty tabs until they have data"),this.$autoshow=e("<input type=checkbox>").prop("checked",t.ajaxHandler&&t.ajaxHandler.autoShow).on("click",function(){t.ajaxHandler&&t.ajaxHandler.setAutoShow(e(this).is(":checked")),t.controls.__datasets&&t.controls.__datasets.get("widget").set("autoshow",e(this).is(":checked"))}),this.bindAttr("autoshow",function(){this.$autoshow.prop("checked",this.get("autoshow")).closest(".form-row").show()}),n.Autoshow=e("<label/>").append(this.$autoshow,"Automatically show new incoming Ajax requests"),n["Reset to defaults"]=e("<button>Reset settings</button>").on("click",b=>{b.preventDefault(),a.clearSettings(),a.render()});for(const[b,x]of Object.entries(n))e("<div />").addClass(o("form-row")).append(e("<div />").addClass(o("form-label")).text(b),e("<div />").addClass(o("form-input")).html(x)).appendTo(a.$el);this.ajaxHandler||this.$autoshow.closest(".form-row").hide()}});class _{constructor(a){this.debugbar=a}format(a,n,b,x){if(b=b?` ${b}`:"",x=x||Object.keys(this.debugbar.datasets).length,n.__meta===void 0)return`#${x}${b}`;const D=n.__meta.uri.split("/");let $=D.pop();$||($=`${D.pop()||""}/`),D.length&&!isNaN($)&&($=`${D.pop()}/${$}`);const i=150;return $.length>i&&($=`${$.substr(0,i)}...`),`#${x} ${$}${b} (${n.__meta.datetime.split(" ")[1]})`}}PhpDebugBar.DatasetTitleFormater=_;const w=PhpDebugBar.DebugBar=h.extend({className:`phpdebugbar ${o("minimized")}`,options:{bodyMarginBottom:!0,theme:"auto",openBtnPosition:"bottomLeft",hideEmptyTabs:!1},initialize(t={}){this.options=Object.assign({},this.options,t),this.defaultOptions=j({},this.options),this.controls={},this.dataMap={},this.datasets={},this.firstTabName=null,this.activePanelName=null,this.activeDatasetId=null,this.datesetTitleFormater=new _(this),this.bodyMarginBottomHeight=Number.parseInt(e("body").css("margin-bottom"));try{this.isIframe=window.self!==window.top&&window.top.phpdebugbar}catch(a){this.isIframe=!1}this.registerResizeHandler(),this.registerMediaListener(),this.settings=new PhpDebugBar.DebugBar.Tab({icon:"adjustments-horizontal",title:"Settings",widget:new p({debugbar:this})})},registerResizeHandler(){if(this.resize.bind===void 0||this.isIframe)return;const t=this.resize.bind(this);this.respCSSSize=0,e(window).resize(t),setTimeout(t,20)},registerMediaListener(){window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",a=>{this.options.theme==="auto"&&this.setTheme("auto")})},setTheme(t){this.options.theme=t,t==="auto"&&(t=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),this.$el.attr("data-theme",t),this.openHandler&&this.openHandler.$el.attr("data-theme",t)},resize(){if(this.isIframe)return;let t=this.respCSSSize;this.respCSSSize===0&&this.$header.find("> *:visible").each(function(){t+=e(this).outerWidth(!0)});const a=this.$header.width(),n=o("mini-design"),b=this.$header.hasClass(n);a<=t&&!b?(this.respCSSSize=t,this.$header.addClass(n)):t<a&&b&&(this.respCSSSize=0,this.$header.removeClass(n)),this.setHeight(this.$body.height())},render(){this.isIframe&&this.$el.hide();const t=this;this.$el.appendTo("body"),this.$dragCapture=e("<div />").addClass(o("drag-capture")).appendTo(this.$el),this.$resizehdle=e("<div />").addClass(o("resize-handle")).appendTo(this.$el),this.$header=e("<div />").addClass(o("header")).appendTo(this.$el),this.$headerBtn=e("<a />").addClass(o("restore-btn")).appendTo(this.$header),this.$headerBtn.click(()=>{t.close()}),this.$headerLeft=e("<div />").addClass(o("header-left")).appendTo(this.$header),this.$headerRight=e("<div />").addClass(o("header-right")).appendTo(this.$header);const a=this.$body=e("<div />").addClass(o("body")).appendTo(this.$el);this.recomputeBottomOffset();let n,b;const x=$=>{const i=b+(n-$.pageY);t.setHeight(i)},D=()=>{a.parents().off("mousemove",x).off("mouseup",D),t.$dragCapture.hide()};this.$resizehdle.on("mousedown",$=>{b=a.height(),n=$.pageY,a.parents().on("mousemove",x).on("mouseup",D),t.$dragCapture.show(),$.preventDefault()}),this.$closebtn=e("<a />").addClass(o("close-btn")).appendTo(this.$headerRight),this.$closebtn.click(()=>{t.close()}),this.$minimizebtn=e("<a />").addClass(o("minimize-btn")).appendTo(this.$headerRight),this.$minimizebtn.click(()=>{t.minimize()}),this.$maximizebtn=e("<a />").addClass(o("maximize-btn")).appendTo(this.$headerRight),this.$maximizebtn.click(()=>{t.restore()}),this.$restorebtn=e("<a />").addClass(o("restore-btn")).hide().appendTo(this.$el),this.$restorebtn.click(()=>{t.restore()}),this.$openbtn=e("<a />").addClass(o("open-btn")).appendTo(this.$headerRight).hide(),this.$openbtn.click(()=>{t.openHandler.show(($,i)=>{t.addDataSet(i,$,"(opened)"),t.showTab()})}),this.$datasets=e("<select />").addClass(o("datasets-switcher")).attr("name","datasets-switcher").appendTo(this.$headerRight),this.$datasets.change(function(){t.showDataSet(this.value)}),this.controls.__settings=this.settings,this.settings.$tab.addClass(o("tab-settings")),this.settings.$tab.attr("data-collector","__settings"),this.settings.$el.attr("data-collector","__settings"),this.settings.$tab.insertAfter(this.$minimizebtn).show(),this.settings.$tab.click(()=>{!this.isMinimized()&&this.activePanelName==="__settings"?this.minimize():(this.showTab("__settings"),this.settings.get("widget").render())}),this.settings.$el.appendTo(this.$body)},setHeight(t){const n=window.innerHeight-this.$header.height()-10;t=Math.min(t,n),t=Math.max(t,40),this.$body.css("height",t),localStorage.setItem("phpdebugbar-height",t),this.recomputeBottomOffset()},restoreState(){if(this.isIframe)return;const t=localStorage.getItem("phpdebugbar-height");this.setHeight(t||this.$body.height());const a=localStorage.getItem("phpdebugbar-open");if(a&&a==="0")this.close();else{const n=localStorage.getItem("phpdebugbar-visible");if(n&&n==="1"){const b=localStorage.getItem("phpdebugbar-tab");this.isTab(b)?this.showTab(b):this.showTab()}}},createTab(t,a,n){const b=new c({title:n||t.replace(/[_-]/g," ").charAt(0).toUpperCase()+t.slice(1),widget:a});return this.addTab(t,b)},addTab(t,a){if(this.isControl(t))throw new Error(`${t} already exists`);const n=this;return a.$tab.appendTo(this.$headerLeft).click(()=>{!n.isMinimized()&&n.activePanelName===t?n.minimize():n.showTab(t)}),a.$tab.attr("data-empty",!0),a.$tab.attr("data-collector",t),a.$el.attr("data-collector",t),a.$el.appendTo(this.$body),this.controls[t]=a,this.firstTabName===null&&(this.firstTabName=t),a},createIndicator(t,a,n,b){const x=new l({icon:a,tooltip:n});return this.addIndicator(t,x,b)},addIndicator(t,a,n){if(this.isControl(t))throw new Error(`${t} already exists`);return a.set("debugbar",this),n==="left"?a.$el.insertBefore(this.$headerLeft.children().first()):a.$el.appendTo(this.$headerRight),this.controls[t]=a,a},getControl(t){if(this.isControl(t))return this.controls[t]},isControl(t){return this.controls[t]!==void 0},isTab(t){return this.isControl(t)&&this.controls[t]instanceof c},isIndicator(t){return this.isControl(t)&&this.controls[t]instanceof l},reset(){this.minimize();for(const[t,a]of Object.entries(this.controls))this.isTab(t)&&a.$tab.remove(),a.$el.remove();this.controls={}},showTab(t){if(t||(this.activePanelName?t=this.activePanelName:t=this.firstTabName),!this.isTab(t))throw new Error(`Unknown tab '${t}'`);this.$resizehdle.show(),this.$body.show(),this.recomputeBottomOffset(),e(this.$header).find(`> div > .${o("active")}`).removeClass(o("active")),e(this.$body).find(`> .${o("active")}`).removeClass(o("active")),this.controls[t].$tab.addClass(o("active")),this.controls[t].$el.addClass(o("active")),this.activePanelName=t,this.$el.removeClass(o("minimized")),localStorage.setItem("phpdebugbar-visible","1"),localStorage.setItem("phpdebugbar-tab",t),this.resize()},minimize(){this.$header.find(`> div > .${o("active")}`).removeClass(o("active")),this.$body.hide(),this.$resizehdle.hide(),this.recomputeBottomOffset(),localStorage.setItem("phpdebugbar-visible","0"),this.$el.addClass(o("minimized")),this.resize()},isMinimized(){return this.$el.hasClass(o("minimized"))},close(){this.$resizehdle.hide(),this.$header.hide(),this.$body.hide(),this.$restorebtn.show(),localStorage.setItem("phpdebugbar-open","0"),this.$el.addClass(o("closed")),this.recomputeBottomOffset()},isClosed(){return this.$el.hasClass(o("closed"))},restore(){this.$resizehdle.show(),this.$header.show(),this.$restorebtn.hide(),localStorage.setItem("phpdebugbar-open","1");const t=localStorage.getItem("phpdebugbar-tab");this.isTab(t)?this.showTab(t):this.showTab(),this.$el.removeClass(o("closed")),this.resize()},recomputeBottomOffset(){if(this.options.bodyMarginBottom){if(this.isClosed())return e("body").css("margin-bottom",this.bodyMarginBottomHeight||"");const t=Number.parseInt(this.$el.height())+(this.bodyMarginBottomHeight||0);e("body").css("margin-bottom",t)}},setDataMap(t){this.dataMap=t},addDataMap(t){Object.assign(this.dataMap,t)},setData(t){return this.datasets={},this.addDataSet(t)},addDataSet(t,a,n,b){if(!t||!t.__meta)return;if(this.isIframe){window.top.phpdebugbar.addDataSet(t,a,`(iframe)${n||""}`,b);return}const x=Object.keys(this.datasets).length+1;a=a||x,t.__meta.nb=x,t.__meta.suffix=n,this.datasets[a]=t;const D=this.datesetTitleFormater.format(a,this.datasets[a],n,x);if(this.datasetTab){this.datasetTab.set("data",this.datasets);const $=Object.keys(this.datasets).length;this.datasetTab.set("badge",$>1?$:null),this.datasetTab.$tab.show()}return this.$datasets.append(e(`<option value="${a}">${D}</option>`)),this.$datasets.children().length>1&&this.$datasets.show(),(b===void 0||b)&&this.showDataSet(a),this.resize(),a},loadDataSet(t,a,n,b){if(!this.openHandler)throw new Error("loadDataSet() needs an open handler");const x=this;this.openHandler.load(t,D=>{x.addDataSet(D,t,a,b),x.resize(),n&&n(D)})},getDataSet(t){return this.datasets[t]},showDataSet(t){this.activeDatasetId=t,this.dataChangeHandler(this.datasets[t]),this.$datasets.val()!==t&&this.$datasets.val(t),this.datasetTab&&this.datasetTab.get("widget").set("id",t)},dataChangeHandler(t){for(const[a,n]of Object.entries(this.dataMap)){const b=s(t,n[0],n[1]);if(a.includes(":")){const x=a.split(":");this.getControl(x[0]).set(x[1],b)}else this.getControl(a).set("data",b)}this.resize()},setOpenHandler(t){this.openHandler=t,this.openHandler.$el.attr("data-theme",this.$el.attr("data-theme")),t!==null?this.$openbtn.show():this.$openbtn.hide()},getOpenHandler(){return this.openHandler},enableAjaxHandlerTab(){this.datasetTab=new PhpDebugBar.DebugBar.Tab({icon:"history",title:"Request history",widget:new PhpDebugBar.Widgets.DatasetWidget({debugbar:this})}),this.datasetTab.$tab.addClass(o("tab-history")),this.datasetTab.$tab.attr("data-collector","__datasets"),this.datasetTab.$el.attr("data-collector","__datasets"),this.datasetTab.$tab.insertAfter(this.$openbtn).hide(),this.datasetTab.$tab.click(()=>{!this.isMinimized()&&this.activePanelName==="__datasets"?this.minimize():this.showTab("__datasets")}),this.datasetTab.$el.appendTo(this.$body),this.controls.__datasets=this.datasetTab}});w.Tab=c,w.Indicator=l;class T{constructor(a,n,b){this.debugbar=a,this.headerName=n||"phpdebugbar",this.autoShow=b===void 0?!0:b,this.defaultAutoShow=this.autoShow,localStorage.getItem("phpdebugbar-ajaxhandler-autoshow")!==null&&(this.autoShow=localStorage.getItem("phpdebugbar-ajaxhandler-autoshow")==="1"),a.controls.__settings&&a.controls.__settings.get("widget").set("autoshow",this.autoShow)}handle(a){return!!(this.loadFromId(a)||this.loadFromData(a))}getHeader(a,n){if(a instanceof Response)return a.headers.get(n);if(a instanceof XMLHttpRequest)return a.getResponseHeader(n)}setAutoShow(a){this.autoShow=a,localStorage.setItem("phpdebugbar-ajaxhandler-autoshow",a?"1":"0")}loadFromId(a){const n=this.extractIdFromHeaders(a);return n&&this.debugbar.openHandler?(this.debugbar.loadDataSet(n,"(ajax)",void 0,this.autoShow),!0):!1}extractIdFromHeaders(a){return this.getHeader(a,`${this.headerName}-id`)}loadFromData(a){const n=this.extractDataFromHeaders(a);if(!n)return!1;const b=this.parseHeaders(n);if(b.error)throw new Error(`Error loading debugbar data: ${b.error}`);return b.data&&this.debugbar.addDataSet(b.data,b.id,"(ajax)",this.autoShow),!0}extractDataFromHeaders(a){let n=this.getHeader(a,this.headerName);if(n){for(let b=1;;b++){const x=this.getHeader(a,`${this.headerName}-${b}`);if(!x)break;n+=x}return decodeURIComponent(n)}}parseHeaders(a){return JSON.parse(a)}bindToFetch(){const a=this,n=window.fetch;n!==void 0&&n.polyfill!==void 0||(window.fetch=function(...b){const x=n.apply(window,b);return x.then(D=>{a.handle(D)}).catch(D=>{}),x})}bindToXHR(){const a=this,n=XMLHttpRequest.prototype.open;XMLHttpRequest.prototype.open=function(b,x,D,$,i){const r=this;r.addEventListener("readystatechange",()=>{r.readyState===4&&a.handle(r)},!1),n.apply(r,[b,x,D,$,i])}}}PhpDebugBar.AjaxHandler=T})(PhpDebugBar.$);typeof PhpDebugBar=="undefined"&&(window.PhpDebugBar={},PhpDebugBar.$=jQuery);(function(e){PhpDebugBar.Widgets={};const s=PhpDebugBar.utils.makecsscls("phpdebugbar-widgets-"),o=PhpDebugBar.Widgets.htmlize=function(i){return i.replace(/\n/g,"<br>").replace(/\s/g,"&nbsp;")},h=PhpDebugBar.Widgets.renderValue=function(i,r){return typeof i!="string"?r?o(JSON.stringify(i,void 0,2)):JSON.stringify(i):i},c=PhpDebugBar.Widgets.highlight=function(i,r){if(typeof i=="string"){if(typeof phpdebugbar_hljs=="undefined")return o(i);const d=phpdebugbar_hljs.default||phpdebugbar_hljs;return r&&d.getLanguage(r)?d.highlight(i,{language:r}).value:d.highlightAuto(i).value}if(typeof phpdebugbar_hljs=="object"){const d=phpdebugbar_hljs.default||phpdebugbar_hljs;i.each((u,f)=>{d.highlightElement(f)})}return i},l=PhpDebugBar.Widgets.createCodeBlock=function(i,r,d,u){const f=e("<pre />").addClass(s("code-block")),y=e("<code />").text(`${i}
`).appendTo(f);if(r&&y.addClass(`language-${r}`),c(y).removeClass("hljs"),!isNaN(Number.parseFloat(d))){const g=i.split(`
`).length,m=e("<ul />").prependTo(f);f.children().addClass(s("numbered-code"));for(let k=d;k<d+g;k++){const C=e("<li />").text(k).appendTo(m);u===k&&C.addClass(s("highlighted-line")).append("<span>&nbsp;</span>")}}return f},{getDictValue:p}=PhpDebugBar.utils,_=PhpDebugBar.Widgets.ListWidget=PhpDebugBar.Widget.extend({tagName:"ul",className:s("list"),initialize(i){i.itemRenderer||(i.itemRenderer=this.itemRenderer),this.set(i)},render(){this.bindAttr(["itemRenderer","data"],function(){if(this.$el.empty(),!this.has("data"))return;const i=this.get("data");for(let r=0;r<i.length;r++){const d=e("<li />").addClass(s("list-item")).appendTo(this.$el);this.get("itemRenderer")(d,i[r])}})},itemRenderer(i,r){i.html(h(r))}}),w=PhpDebugBar.Widgets.KVListWidget=_.extend({tagName:"dl",className:s("kvlist"),render(){this.bindAttr(["itemRenderer","data"],function(){if(this.$el.empty(),!!this.has("data"))for(const[i,r]of Object.entries(this.get("data"))){const d=e("<dt />").addClass(s("key")).appendTo(this.$el),u=e("<dd />").addClass(s("value")).appendTo(this.$el);this.get("itemRenderer")(d,u,i,r)}})},itemRenderer(i,r,d,u){i.text(d),r.html(o(u))}}),T=PhpDebugBar.Widgets.VariableListWidget=w.extend({className:s("kvlist varlist"),itemRenderer(i,r,d,u){e("<span />").attr("title",d).text(d).appendTo(i);let f=u&&u.value||u;f&&f.length>100&&(f=`${f.substr(0,100)}...`);let y=null;r.text(f).click(()=>{if(window.getSelection().type==="Range")return"";r.hasClass(s("pretty"))?r.text(f).removeClass(s("pretty")):(y=y||l(u),r.addClass(s("pretty")).empty().append(y))})}}),t=PhpDebugBar.Widgets.HtmlVariableListWidget=w.extend({className:s("kvlist htmlvarlist"),itemRenderer(i,r,d,u){if(e("<span />").attr("title",e("<i />").html(d!=null?d:"").text()).html(d!=null?d:"").appendTo(i),r.html(u&&u.value||u),u&&u.xdebug_link){const f=e("<span />").addClass(s("filename")).text(u.xdebug_link.filename+(u.xdebug_link.line?`#${u.xdebug_link.line}`:""));u.xdebug_link&&(u.xdebug_link.ajax?e(`<a title="${u.xdebug_link.url}"></a>`).on("click",()=>{fetch(u.xdebug_link.url)}).addClass(s("editor-link")).appendTo(f):e(`<a href="${u.xdebug_link.url}"></a>`).addClass(s("editor-link")).appendTo(f)),f.appendTo(r)}}}),a=PhpDebugBar.Widgets.TableVariableListWidget=PhpDebugBar.Widget.extend({tagName:"div",className:s("tablevarlist"),render(){this.bindAttr("data",function(i){var y;if(this.$el.empty(),!this.has("data"))return;this.$table=e("<table />").addClass(s("tablevar")).appendTo(this.$el);const r=e("<tr />").addClass(s("header")).append("<td />").appendTo(this.$table);let d=i.key_map||{value:"Value"};Array.isArray(d)&&(d=Object.fromEntries(d.map(g=>[g,null]))),e.each(d,(g,m)=>{const k=e("<td />").text(m!=null?m:g).appendTo(r);i.badges&&i.badges[g]&&e("<span />").text(i.badges[g]).addClass(s("badge")).appendTo(k)});const u=this;if(e.each(i.data,(g,m)=>{const k=e("<tr />").addClass(s("item")).appendTo(u.$table);if(e("<td />").addClass(s("key")).text(g).appendTo(k),typeof m!="object"||m===null){e("<td />").addClass(s("value")).text(m!=null?m:"").appendTo(k);return}if(e.each(d,C=>{var S;e("<td />").addClass(s("value")).text((S=m[C])!=null?S:"").appendTo(k)}),m.xdebug_link){const C=e("<span />").addClass(s("filename")).text(m.xdebug_link.filename+(m.xdebug_link.line?`#${m.xdebug_link.line}`:"")).appendTo(e("<td />").addClass(s("editor")).appendTo(k));m.xdebug_link.ajax?e(`<a title="${m.xdebug_link.url}"></a>`).on("click",()=>{fetch(m.xdebug_link.url)}).addClass(s("editor-link")).appendTo(C):e(`<a href="${m.xdebug_link.url}"></a>`).addClass(s("editor-link")).appendTo(C),i.xdebug_link||(i.xdebug_link=!0,r.append(e("<td />")))}}),!i.summary)return;const f=e("<tr />").addClass(s("summary")).appendTo(u.$table);e("<td />").addClass(s("key")).appendTo(f),typeof i.summary!="object"||i.summary===null?e("<td />").addClass(s("value")).text((y=i.summary)!=null?y:"").appendTo(f):e.each(d,g=>{var m;e("<td />").addClass(s("value")).text((m=i.summary[g])!=null?m:"").appendTo(f)}),i.xdebug_link&&e("<td />").appendTo(f)})}}),n=PhpDebugBar.Widgets.IFrameWidget=PhpDebugBar.Widget.extend({tagName:"iframe",className:s("iframe"),render(){this.$el.attr({seamless:"seamless",border:"0",width:"100%",height:"100%"}),this.bindAttr("data",function(i){this.$el.attr("src",i)})}}),b=PhpDebugBar.Widgets.MessagesWidget=PhpDebugBar.Widget.extend({className:s("messages"),render(){const i=this;this.$list=new _({itemRenderer(r,d){let u;if(d.message_html)u=e("<span />").addClass(s("value")).html(d.message_html).appendTo(r);else{let f=d.message;if(f.length>100&&(f=`${f.substr(0,100)}...`),u=e("<span />").addClass(s("value")).text(f).appendTo(r),!d.is_string||d.message.length>100){let y=d.message;d.is_string||(y=null),r.css("cursor","pointer").click(()=>{if(window.getSelection().type==="Range")return"";u.hasClass(s("pretty"))?u.text(f).removeClass(s("pretty")):(y=y||l(d.message,"php"),u.addClass(s("pretty")).empty().append(y))})}}if(d.xdebug_link){const f=e("<span />").addClass(s("filename")).text(d.xdebug_link.filename+(d.xdebug_link.line?`#${d.xdebug_link.line}`:""));d.xdebug_link&&(d.xdebug_link.ajax?e(`<a title="${d.xdebug_link.url}"></a>`).on("click",()=>{fetch(d.xdebug_link.url)}).addClass(s("editor-link")).appendTo(f):e(`<a href="${d.xdebug_link.url}"></a>`).addClass(s("editor-link")).appendTo(f)),f.prependTo(r)}d.collector&&e("<span />").addClass(s("collector")).text(d.collector).prependTo(r),d.label&&(u.addClass(s(d.label)),e("<span />").addClass(s("label")).text(d.label).prependTo(r))}}),this.$list.$el.appendTo(this.$el),this.$toolbar=e('<div><i class="phpdebugbar-icon phpdebugbar-icon-search"></i></div>').addClass(s("toolbar")).appendTo(this.$el),e('<input type="text" name="search" aria-label="Search" placeholder="Search" />').on("change",function(){i.set("search",this.value)}).appendTo(this.$toolbar),this.bindAttr("data",function(r){this.set({excludelabel:[],excludecollector:[],search:""}),this.$toolbar.find(s(".filter")).remove();const d=[],u=[],f=this,y=function(g,m){e("<a />").addClass(s("filter")).addClass(s(g)).text(m).attr("rel",m).on("click",function(){f.onFilterClick(this,g)}).appendTo(f.$toolbar)};r.forEach(g=>{d.includes(g.label||"none")||d.push(g.label||"none"),u.includes(g.collector||"none")||u.push(g.collector||"none")}),d.length>1&&d.forEach(g=>y("label",g)),u.length!==1&&(e("<a />").addClass(s("filter")).css("visibility","hidden").appendTo(f.$toolbar),u.forEach(g=>y("collector",g)))}),this.bindAttr(["excludelabel","excludecollector","search"],function(){const r=this.get("excludelabel")||[],d=this.get("excludecollector")||[],u=this.get("search");let f=!1;const y=[];u&&u===u.toLowerCase()&&(f=!0),this.get("data").forEach(g=>{const m=f?g.message.toLowerCase():g.message;!r.includes(g.label||void 0)&&!d.includes(g.collector||void 0)&&(!u||m.includes(u))&&y.push(g)}),this.$list.set("data",y)})},onFilterClick(i,r){e(i).toggleClass(s("excluded"));const d=[];this.$toolbar.find(s(".filter")+s(".excluded")+s(`.${r}`)).each(function(){d.push(this.rel==="none"||!this.rel?void 0:this.rel)}),this.set(`exclude${r}`,d)}}),x=PhpDebugBar.Widgets.TimelineWidget=PhpDebugBar.Widget.extend({tagName:"ul",className:s("timeline"),render(){this.bindAttr("data",function(i){const r=function(u){return u<.001?`${(u*1e6).toFixed()}\u03BCs`:u<.1?`${(u*1e3).toFixed(2)}ms`:u<1?`${(u*1e3).toFixed()}ms`:`${u.toFixed(2)}s`},d=function(f){if(f===0||f===null)return"0B";const y=f<0?"-":"",g=Math.abs(f),m=Math.log(g)/Math.log(1024),k=["B","KB","MB","GB","TB"];return y+Math.round(A(1024,m-Math.floor(m))*100)/100+k[Math.floor(m)]};if(this.$el.empty(),i.measures){let u={};for(let y=0;y<i.measures.length;y++){const g=i.measures[y],m=g.group||g.label;u[m]||(u[m]={count:0,duration:0,memory:0}),u[m].count+=1,u[m].duration+=g.duration,u[m].memory+=g.memory||0;const k=e("<div />").addClass(s("measure")),C=e("<li />"),S=(g.relative_start*100/i.duration).toFixed(2),B=Math.min((g.duration*100/i.duration).toFixed(2),100-S);if(k.append(e("<span />").addClass(s("value")).css({left:`${S}%`,width:`${B}%`})),k.append(e("<span />").addClass(s("label")).text(g.label.replace(/\s+/g," ")+(g.duration?` (${g.duration_str}${g.memory?`/${g.memory_str}`:""})`:""))),g.collector&&e("<span />").addClass(s("collector")).text(g.collector).appendTo(k),k.appendTo(C),this.$el.append(C),g.params&&!e.isEmptyObject(g.params)){const P=e('<table><tr><th colspan="2">Params</th></tr></table>').hide().addClass(s("params")).appendTo(C);for(const v in g.params)typeof g.params[v]!="function"&&P.append(`<tr><td class="${s("name")}">${v}</td><td class="${s("value")}"><pre><code>${g.params[v]}</code></pre></td></tr>`);C.css("cursor","pointer").click(function(){if(window.getSelection().type==="Range")return"";const v=e(this).find("table");v.is(":visible")?v.hide():v.show()}).on("click",".sf-dump",v=>{v.stopPropagation()})}}u=e.map(u,(y,g)=>({label:g,data:y})).sort((y,g)=>g.data.duration-y.data.duration);const f=e("<table></table>").addClass(s("params"));e.each(u,(y,g)=>{const m=Math.min((g.data.duration*100/i.duration).toFixed(2),100);f.append(`<tr><td class="${s("name")}">${g.data.count} x ${e("<i />").text(g.label.replace(/\s+/g," ")).html()} (${m}%)</td><td class="${s("value")}"><div class="${s("measure")}"><span class="${s("value")}"></span><span class="${s("label")}">${r(g.data.duration)}${g.data.memory?`/${d(g.data.memory)}`:""}</span></div></td></tr>`),f.find(`span.${s("value")}:last`).css({width:`${m}%`})}),this.$el.append("<li/>").find("li:last").append(f)}})}}),D=PhpDebugBar.Widgets.ExceptionsWidget=PhpDebugBar.Widget.extend({className:s("exceptions"),render(){this.$list=new _({itemRenderer(i,r){if(e("<span />").addClass(s("message")).text(r.message).prepend(r.count>1?e("<span />").addClass(s("badge")).text(`${r.count}x`):"").appendTo(i),r.file){const d=e("<span />").addClass(s("filename")).text(`${r.file}#${r.line}`);r.xdebug_link&&(r.xdebug_link.ajax?e(`<a title="${r.xdebug_link.url}"></a>`).on("click",()=>{fetch(r.xdebug_link.url)}).addClass(s("editor-link")).appendTo(d):e(`<a href="${r.xdebug_link.url}"></a>`).addClass(s("editor-link")).appendTo(d)),d.appendTo(i)}if(r.type&&e("<span />").addClass(s("type")).text(r.type).appendTo(i),r.surrounding_lines){const d=r.line-3<=0?1:r.line-3,u=l(r.surrounding_lines.join(""),"php",d,r.line).addClass(s("file")).appendTo(i);r.stack_trace_html||i.click(()=>{u.is(":visible")?u.hide():u.show()})}if(r.stack_trace_html){const d=e("<span />").addClass(s("filename")).html(r.stack_trace_html);d.find('samp[data-depth="1"]').removeClass("sf-dump-expanded").addClass("sf-dump-compact").parent().find(">.sf-dump-note").html((u,f)=>`${f.replace(/^array:/,'<span class="sf-dump-key">Stack Trace:</span> ')} files`),d.appendTo(i)}else r.stack_trace&&r.stack_trace.split(`
`).forEach(d=>{const u=e("<div />");e("<span />").addClass(s("filename")).text(d).appendTo(u),u.appendTo(i)})}}),this.$list.$el.appendTo(this.$el),this.bindAttr("data",function(i){this.$list.set("data",i),i.length===1&&this.$list.$el.children().first().find(s(".file")).show()})}}),$=PhpDebugBar.Widgets.DatasetWidget=PhpDebugBar.Widget.extend({initialize(i){i.itemRenderer||(i.itemRenderer=this.itemRenderer),this.set(i),this.set("autoshow",null),this.set("id",null),this.set("sort",localStorage.getItem("debugbar-history-sort")||"asc"),this.$el.addClass(s("dataset-history")),this.renderHead()},renderHead(){this.$el.empty(),this.$actions=e("<div />").addClass(s("dataset-actions")).appendTo(this.$el);const i=this,r=i.get("debugbar");this.$autoshow=e("<input type=checkbox>").on("click",function(){r.ajaxHandler&&r.ajaxHandler.setAutoShow(e(this).is(":checked")),r.controls.__settings&&r.controls.__settings.get("widget").set("autoshow",this.autoShow)}),e("<label>Autoshow</label>").append(this.$autoshow).appendTo(this.$actions),this.$clearbtn=e("<a>Clear</a>").appendTo(this.$actions).on("click",()=>{i.$table.empty()}),this.$showBtn=e("<a>Show all</a>").appendTo(this.$actions).on("click",()=>{i.searchInput.val(null),i.methodInput.val(null),i.set("search",null),i.set("method",null)}),this.methodInput=e('<select name="method" style="width:100px"><option>(method)</option><option>GET</option><option>POST</option><option>PUT</option><option>DELETE</option></select>').on("change",function(){i.set("method",this.value)}).appendTo(this.$actions),this.searchInput=e('<input type="text" name="search" aria-label="Search" placeholder="Search" />').on("input",function(){i.set("search",this.value)}).appendTo(this.$actions),this.$table=e("<tbody />"),e("<table/>").append(e("<thead/>").append(e("<tr/>").append(e("<th></th>").css("width","30px")).append(e("<th>Date \u2195</th>").css("width","175px").click(()=>{i.set("sort",i.get("sort")==="asc"?"desc":"asc"),localStorage.setItem("debugbar-history-sort",i.get("sort"))})).append(e("<th>Method</th>").css("width","80px")).append(e("<th>URL</th>")).append(e('<th width="40%">Data</th>')))).append(this.$table).appendTo(this.$el)},renderDatasets(){this.$table.empty();const i=this;e.each(this.get("data"),(r,d)=>{d.__meta&&i.get("itemRenderer")(i,d)})},render(){this.bindAttr("data",function(){if(this.get("autoshow")===null&&this.get("debugbar").ajaxHandler&&this.set("autoshow",this.get("debugbar").ajaxHandler.autoShow),!this.has("data"))return;const i=this.get("data"),r=i[Object.keys(i)[Object.keys(i).length-1]];r.__meta&&this.get("itemRenderer")(this,r)}),this.bindAttr(["itemRenderer","search","method","sort"],function(){this.renderDatasets()}),this.bindAttr("autoshow",function(){const i=this.get("autoshow");this.$autoshow.prop("checked",i)}),this.bindAttr("id",function(){const i=this.get("id");this.$table.find(`.${s("active")}`).removeClass(s("active")),this.$table.find(`tr[data-id=${i}]`).addClass(s("active"))})},itemRenderer(i,r){const d=r.__meta,u=e("<td />"),f=e("<tr />");i.get("sort")==="asc"?f.appendTo(i.$table):f.prependTo(i.$table);const y=function(){const C=i.get("debugbar");C.showDataSet(d.id,C.datesetTitleFormater.format("",r,d.suffix,d.nb)),i.$table.find(`.${s("active")}`).removeClass(s("active")),f.addClass(s("active")),e(this).data("tab")&&C.showTab(e(this).data("tab"))};f.attr("data-id",d.id).append(e(`<td>#${d.nb}</td>`).click(y)).append(e(`<td>${d.datetime}</td>`).click(y)).append(e(`<td>${d.method}</td>`).click(y)).append(e("<td />").append(d.uri+(d.suffix?` ${d.suffix}`:"")).click(y)).css("cursor","pointer").addClass(s("table-row"));const g=i.get("debugbar");e.each(g.dataMap,(C,S)=>{const B=p(r,S[0],S[1]);if(C.includes(":"))if(C=C.split(":"),C[1]==="badge"&&B>0){const P=g.getControl(C[0]),v=e("<a>").attr("title",P.get("title")).data("tab",C[0]);P.$icon&&v.append(g.getControl(C[0]).$icon.clone()),P.$badge&&v.append(g.getControl(C[0]).$badge.clone().css("display","inline-block").text(B)),v.appendTo(u).click(y)}else C[1]==="tooltip"&&g.getControl(C[0]).set("tooltip",B)}),f.append(u),g.activeDatasetId===d.id&&f.addClass(s("active"));const m=i.get("search"),k=i.get("method");(m&&!d.uri.includes(m)||k&&d.method!==k)&&f.hide()}})})(PhpDebugBar.$);typeof PhpDebugBar=="undefined"&&(window.PhpDebugBar={},PhpDebugBar.$=jQuery);(function(e){const s=function(o){return PhpDebugBar.utils.csscls(o,"phpdebugbar-openhandler-")};PhpDebugBar.OpenHandler=PhpDebugBar.Widget.extend({className:"phpdebugbar-openhandler",defaults:{items_per_page:20},render(){const o=this;this.$el.appendTo("body").hide(),this.$closebtn=e('<a><i class="phpdebugbar-icon phpdebugbar-icon-x"></i></a>'),this.$table=e("<tbody />"),e("<div>PHP DebugBar | Open</div>").addClass(s("header")).append(this.$closebtn).appendTo(this.$el),e('<table><thead><tr><th width="155">Date</th><th width="75">Method</th><th>URL</th><th width="125">IP</th><th width="100">Filter data</th></tr></thead></table>').append(this.$table).appendTo(this.$el),this.$actions=e("<div />").addClass(s("actions")).appendTo(this.$el),this.$closebtn.on("click",()=>{o.hide()}),this.$loadmorebtn=e("<a>Load more</a>").appendTo(this.$actions).on("click",()=>{o.find(o.last_find_request,o.last_find_request.offset+o.get("items_per_page"),o.handleFind.bind(o))}),this.$showonlycurrentbtn=e("<a>Show only current URL</a>").appendTo(this.$actions).on("click",()=>{o.$table.empty(),o.find({uri:window.location.pathname},0,o.handleFind.bind(o))}),this.$showallbtn=e("<a>Show all</a>").appendTo(this.$actions).on("click",()=>{o.refresh()}),this.$clearbtn=e("<a>Delete all</a>").appendTo(this.$actions).on("click",()=>{o.clear(()=>{o.hide()})}),this.addSearch(),this.$overlay=e("<div />").addClass(s("overlay")).hide().appendTo("body"),this.$overlay.on("click",()=>{o.hide()})},refresh(){this.$table.empty(),this.$loadmorebtn.show(),this.find({},0,this.handleFind.bind(this))},addSearch(){const o=this,h=e("<button />").text("Search").attr("type","submit").on("click",function(c){o.$table.empty();const l={},p=e(this).parent().serializeArray();e.each(p,function(){this.value&&(l[this.name]=this.value)}),o.find(l,0,o.handleFind.bind(o)),c.preventDefault()});e("<form />").append("<br/><b>Filter results</b><br/>").append('<select name="method"><option selected>(Method)</option><option>GET</option><option>POST</option><option>PUT</option><option>DELETE</option></select>').append('<input type="text" name="uri" placeholder="URI">').append('<input type="text" name="ip" placeholder="IP">').append(h).appendTo(this.$actions)},handleFind(o){const h=this;e.each(o,(c,l)=>{const p=e("<a />").text("Load dataset").on("click",a=>{h.hide(),h.load(l.id,n=>{h.callback(l.id,n)}),a.preventDefault()}),_=e("<a />").text(l.method).on("click",a=>{h.$table.empty(),h.find({method:l.method},0,h.handleFind.bind(h)),a.preventDefault()}),w=e("<a />").text(l.uri).on("click",a=>{h.hide(),h.load(l.id,n=>{h.callback(l.id,n)}),a.preventDefault()}),T=e("<a />").text(l.ip).on("click",a=>{h.$table.empty(),h.find({ip:l.ip},0,h.handleFind.bind(h)),a.preventDefault()}),t=e("<a />").text("Show URL").on("click",a=>{h.$table.empty(),h.find({uri:l.uri},0,h.handleFind.bind(h)),a.preventDefault()});e("<tr />").append(`<td>${l.datetime}</td>`).append(`<td>${l.method}</td>`).append(e("<td />").append(w)).append(e("<td />").append(T)).append(e("<td />").append(t)).appendTo(h.$table)}),o.length<this.get("items_per_page")&&this.$loadmorebtn.hide()},show(o){this.callback=o,this.$el.show(),this.$overlay.show(),this.refresh()},hide(){this.$el.hide(),this.$overlay.hide()},find(o,h,c){const l=Object.assign({},o,{max:this.get("items_per_page"),offset:h||0});this.last_find_request=l,this.ajax(l,c)},load(o,h){this.ajax({op:"get",id:o},h)},clear(o){this.ajax({op:"clear"},o)},ajax(o,h){let c=this.get("url");o&&(c=c+(c.includes("?")?"&":"?")+new URLSearchParams(o)),fetch(c,{method:"GET",headers:{Accept:"application/json"}}).then(l=>l.json()).then(h)}})})(PhpDebugBar.$);(function(e){const s=PhpDebugBar.utils.makecsscls("phpdebugbar-widgets-"),o=PhpDebugBar.Widgets.SQLQueriesWidget=PhpDebugBar.Widget.extend({className:s("sqlqueries"),onFilterClick(h){e(h).toggleClass(s("excluded")),this.$list.$el.find(`li[connection=${e(h).attr("rel")}]`).toggle()},onCopyToClipboard(h){const c=e(h).parent("li").find("code").get(0),l=function(){try{document.execCommand("copy")&&(e(h).addClass(s("copy-clipboard-check")),setTimeout(()=>{e(h).removeClass(s("copy-clipboard-check"))},2e3))}catch(_){console.log("Oops, unable to copy")}};(function(_){if(document.selection){const w=document.body.createTextRange();w.moveToElementText(_),w.select()}else if(window.getSelection){const w=document.createRange();w.selectNodeContents(_),window.getSelection().removeAllRanges(),window.getSelection().addRange(w)}l(),window.getSelection().removeAllRanges()})(c)},renderList(h,c,l){const p=e("<ul />").addClass(s("table-list")),_=e("<li />").addClass(s("table-list-item")),w=e("<span />").addClass("phpdebugbar-text-muted");for(const T in l){const t=typeof l[T]=="function"?`${l[T].name} {}`:l[T];_.clone().append(typeof t=="object"&&t!==null?[w.clone().text(t.index||T).append("."),"&nbsp;"].concat(t.namespace?[`${t.namespace}::`]:[]).concat([t.name||t.file]).concat(t.line?[w.clone().text(`:${t.line}`)]:[]):[w.clone().text(`${T}:`),"&nbsp;",w.clone().text(t).html()]).appendTo(p)}return h+=c?` <i class="phpdebugbar-fa phpdebugbar-fa-${c} phpdebugbar-text-muted"></i>`:"",e("<tr />").append(e("<td />").addClass(s("name")).html(h),e("<td />").addClass(s("value")).append(p))},render(){this.$status=e("<div />").addClass(s("status")).appendTo(this.$el),this.$toolbar=e("<div />").addClass(s("toolbar")).appendTo(this.$el);let h=[];const c=this;this.$list=new PhpDebugBar.Widgets.ListWidget({itemRenderer(l,p){if(p.slow&&l.addClass(s("sql-slow")),p.width_percent&&e("<div />").addClass(s("bg-measure")).append(e("<div />").addClass(s("value")).css({left:`${p.start_percent}%`,width:`${Math.max(p.width_percent,.01)}%`})).appendTo(l),p.duration_str&&e('<span title="Duration" />').addClass(s("duration")).text(p.duration_str).appendTo(l),p.memory_str&&e('<span title="Memory usage" />').addClass(s("memory")).text(p.memory_str).appendTo(l),typeof p.row_count!="undefined"&&e('<span title="Row count" />').addClass(s("row-count")).text(p.row_count).appendTo(l),typeof p.stmt_id!="undefined"&&p.stmt_id&&e('<span title="Prepared statement ID" />').addClass(s("stmt-id")).text(p.stmt_id).appendTo(l),p.connection&&(e('<span title="Connection" />').addClass(s("database")).text(p.connection).appendTo(l),l.attr("connection",p.connection),e.inArray(p.connection,h)===-1&&(h.push(p.connection),e("<a />").addClass(s("filter")).text(p.connection).attr("rel",p.connection).on("click",function(){c.onFilterClick(this)}).appendTo(c.$toolbar),h.length>1&&(c.$toolbar.show(),c.$list.$el.css("margin-bottom","20px")))),(!p.type||p.type==="query")&&e('<span title="Copy to clipboard" />').addClass(s("copy-clipboard")).css("cursor","pointer").html("&#8203;").on("click",function(w){c.onCopyToClipboard(this),w.stopPropagation()}).appendTo(l),typeof p.xdebug_link!="undefined"&&p.xdebug_link){const w=e('<span title="Filename" />').addClass(s("filename")).text(p.xdebug_link.filename+(p.xdebug_link.line?`#${p.xdebug_link.line}`:""));e(`<a href="${p.xdebug_link.url}"></a>`).on("click",()=>{event.stopPropagation(),p.xdebug_link.ajax&&(fetch(p.xdebug_link.url),event.preventDefault())}).addClass(s("editor-link")).appendTo(w),w.appendTo(l)}p.type==="transaction"?e("<strong />").addClass(s("sql")).addClass(s("name")).text(p.sql).appendTo(l):e("<code />").addClass(s("sql")).html(PhpDebugBar.Widgets.highlight(p.sql,"sql")).appendTo(l),typeof p.is_success!="undefined"&&!p.is_success&&(l.addClass(s("error")),l.append(e("<span />").addClass(s("error")).text(`[${p.error_code}] ${p.error_message}`)));const _=e("<table></table>").addClass(s("params"));p.params&&!e.isEmptyObject(p.params)&&c.renderList("Params","thumb-tack",p.params).appendTo(_),p.bindings&&!e.isEmptyObject(p.bindings)&&c.renderList("Bindings","thumb-tack",p.bindings).appendTo(_),p.hints&&!e.isEmptyObject(p.hints)&&c.renderList("Hints","question-circle",p.hints).appendTo(_),p.backtrace&&!e.isEmptyObject(p.backtrace)&&c.renderList("Backtrace","list-ul",p.backtrace).appendTo(_),_.find("tr").length&&(_.appendTo(l),l.css("cursor","pointer").click(()=>{if(window.getSelection().type==="Range")return"";_.is(":visible")?_.hide():_.show()}))}}),this.$list.$el.appendTo(this.$el),this.bindAttr("data",function(l){if(l.length<=0||!l.statements)return!1;h=[],this.$toolbar.hide().find(s(".filter")).remove(),this.$list.set("data",l.statements),this.$status.empty();const p={};let _=0;for(let T=0;T<l.statements.length;T++){if(l.statements[T].type&&l.statements[T].type!=="query")continue;let t=l.statements[T].sql;l.statements[T].params&&!e.isEmptyObject(l.statements[T].params)&&(t+=JSON.stringify(l.statements[T].params)),l.statements[T].bindings&&!e.isEmptyObject(l.statements[T].bindings)&&(t+=JSON.stringify(l.statements[T].bindings)),l.statements[T].connection&&(t+=`@${l.statements[T].connection}`),p[t]=p[t]||{keys:[]},p[t].keys.push(T)}for(const T in p)if(p[T].keys.length>1){_+=p[T].keys.length;for(let t=0;t<p[T].keys.length;t++)this.$list.$el.find(`.${s("list-item")}`).eq(p[T].keys[t]).addClass(s("sql-duplicate"))}const w=e("<span />").text(`${l.nb_statements} statements were executed`).appendTo(this.$status);if(l.nb_failed_statements&&w.append(`, ${l.nb_failed_statements} of which failed`),_){w.append(`, ${_} of which were duplicates`),w.append(`, ${l.nb_statements-_} unique. `);const T="Show only duplicated";e("<a />").addClass(s("duplicates")).click(function(){e(this).toggleClass("shown-duplicated").text(e(this).hasClass("shown-duplicated")?"Show All":T),e(`.${c.className} .${s("list-item")}`).not(`.${s("sql-duplicate")}`).toggle()}).text(T).appendTo(w)}l.accumulated_duration_str&&this.$status.append(e('<span title="Accumulated duration" />').addClass(s("duration")).text(l.accumulated_duration_str)),l.memory_usage_str&&this.$status.append(e('<span title="Memory usage" />').addClass(s("memory")).text(l.memory_usage_str))})}})})(PhpDebugBar.$);(function(e){const s=PhpDebugBar.utils.makecsscls("phpdebugbar-widgets-"),o=PhpDebugBar.Widgets.TemplatesWidget=PhpDebugBar.Widget.extend({className:s("templates"),render(){this.$status=e("<div />").addClass(s("status")).appendTo(this.$el),this.$list=new PhpDebugBar.Widgets.ListWidget({itemRenderer(h,c){const l=e("<span />").addClass(s("name")).appendTo(h);if(c.html?l.html(c.html):l.text(c.name),typeof c.xdebug_link!="undefined"&&c.xdebug_link!==null){const p=e("<span />").addClass(s("filename")).text(c.xdebug_link.filename+(c.xdebug_link.line?`#${c.xdebug_link.line}`:""));c.xdebug_link&&e(`<a href="${c.xdebug_link.url}"></a>`).on("click",()=>{event.stopPropagation(),c.xdebug_link.ajax&&(fetch(c.xdebug_link.url),event.preventDefault())}).addClass(s("editor-link")).appendTo(p),p.appendTo(h)}if(c.render_time_str&&e('<span title="Render time" />').addClass(s("render-time")).text(c.render_time_str).appendTo(h),c.memory_str&&e('<span title="Memory usage" />').addClass(s("memory")).text(c.memory_str).appendTo(h),typeof c.param_count!="undefined"&&e('<span title="Parameter count" />').addClass(s("param-count")).text(c.param_count).appendTo(h),typeof c.type!="undefined"&&c.type&&e('<span title="Type" />').addClass(s("type")).text(c.type).appendTo(h),typeof c.editorLink!="undefined"&&c.editorLink&&e(`<a href="${c.editorLink}" />`).on("click",p=>{p.stopPropagation()}).addClass(s("editor-link")).text("file").appendTo(h),c.params&&!e.isEmptyObject(c.params)){const p=e('<table><tr><th colspan="2">Params</th></tr></table>').addClass(s("params")).appendTo(h);for(const _ in c.params)typeof c.params[_]!="function"&&p.append(`<tr><td class="${s("name")}">${_}</td><td class="${s("value")}"><pre><code>${c.params[_]}</code></pre></td></tr>`);h.css("cursor","pointer").click(()=>{if(window.getSelection().type==="Range")return"";p.is(":visible")?p.hide():p.show()})}}}),this.$list.$el.appendTo(this.$el),this.$callgraph=e("<div />").addClass(s("callgraph")).appendTo(this.$el),this.bindAttr("data",function(h){this.$list.set("data",h.templates),this.$status.empty(),this.$callgraph.empty();const c=h.sentence||"templates were rendered";e("<span />").text(`${h.nb_templates} ${c}`).appendTo(this.$status),h.accumulated_render_time_str&&this.$status.append(e('<span title="Accumulated render time" />').addClass(s("render-time")).text(h.accumulated_render_time_str)),h.memory_usage_str&&this.$status.append(e('<span title="Memory usage" />').addClass(s("memory")).text(h.memory_usage_str)),h.nb_blocks>0&&e("<div />").text(`${h.nb_blocks} blocks were rendered`).appendTo(this.$status),h.nb_macros>0&&e("<div />").text(`${h.nb_macros} macros were rendered`).appendTo(this.$status),typeof h.callgraph!="undefined"&&this.$callgraph.html(h.callgraph)})}})})(PhpDebugBar.$);(function(e){const s=PhpDebugBar.utils.makecsscls("phpdebugbar-widgets-"),o=PhpDebugBar.Widgets.MailsWidget=PhpDebugBar.Widget.extend({className:s("mails"),render(){this.$list=new PhpDebugBar.Widgets.ListWidget({itemRenderer(h,c){if(e("<span />").addClass(s("subject")).text(c.subject).appendTo(h),e("<span />").addClass(s("to")).text(c.to).appendTo(h),c.body||c.html){const l=e("<span />").addClass(s("filename")).text("");e('<a title="Mail Preview">View Mail</a>').on("click",()=>{const _=window.open("about:blank","Mail Preview","width=650,height=440,scrollbars=yes").document,w=c.headers?e('<pre style="border: 1px solid #ddd; padding: 5px;" />').append(e("<code />").text(c.headers)):"";let T=e('<pre style="border: 1px solid #ddd; padding: 5px;" />').text(c.body),t=null;c.html&&(T=e("<details />").append(e("<summary>Text version</summary>")).append(T),t=e('<iframe width="100%" height="400px" sandbox="" referrerpolicy="no-referrer"/>').attr("srcdoc",c.html)),_.open(),_.write(w.prop("outerHTML")+T.prop("outerHTML")+(t?t.prop("outerHTML"):"")),_.close()}).addClass(s("editor-link")).appendTo(l),l.appendTo(h)}if(c.headers){const l=e("<pre />").addClass(s("headers")).appendTo(h);e("<code />").text(c.headers).appendTo(l),h.click(()=>{l.is(":visible")?l.hide():l.show()})}}}),this.$list.$el.appendTo(this.$el),this.bindAttr("data",function(h){this.$list.set("data",h)})}})})(PhpDebugBar.$);})();
