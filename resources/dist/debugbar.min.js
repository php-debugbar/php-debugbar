(()=>{var F=Object.defineProperty;var z=Object.getOwnPropertySymbols;var q=Object.prototype.hasOwnProperty,V=Object.prototype.propertyIsEnumerable;var O=Math.pow,R=(t,k,l)=>k in t?F(t,k,{enumerable:!0,configurable:!0,writable:!0,value:l}):t[k]=l,I=(t,k)=>{for(var l in k||(k={}))q.call(k,l)&&R(t,l,k[l]);if(z)for(var l of z(k))V.call(k,l)&&R(t,l,k[l]);return t};var N=(t,k,l)=>R(t,typeof k!="symbol"?k+"":k,l);window.PhpDebugBar=window.PhpDebugBar||{};(function(){const t=window.PhpDebugBar;t.utils=t.utils||{};const k=t.utils.getDictValue=function(y,r,e){if(y==null)return e;const s=String(r).split(".");let d=y;for(const L of s)if(d==null||(d=d[L],d===void 0))return e;return d};t.utils.csscls=function(y,r){const e=String(y).trim();return e.includes(" ")?e.split(/\s+/).filter(Boolean).map(s=>t.utils.csscls(s,r)).join(" "):e.startsWith(".")?`.${r}${e.slice(1)}`:r+e},t.utils.makecsscls=function(y){return r=>t.utils.csscls(r,y)};const l=t.utils.makecsscls("phpdebugbar-");class p{get tagName(){return"div"}constructor(r={}){this._attributes=I({},this.defaults),this._boundAttributes={},this.el=document.createElement(this.tagName),this.className&&this.el.classList.add(...this.className.split(" ")),this.initialize(r),this.render()}initialize(r){this.set(r)}render(){}set(r,e){if(typeof r!="string"){for(const s in r)this.set(s,r[s]);return}if(this._attributes[r]=e,this._boundAttributes[r])for(const s of this._boundAttributes[r])s.call(this,e)}has(r){return this._attributes[r]!==void 0&&this._attributes[r]!==null}get(r){return this._attributes[r]}bindAttr(r,e){if(Array.isArray(r)){for(const s of r)this.bindAttr(s,e);return}if(this._boundAttributes[r]||(this._boundAttributes[r]=[]),e instanceof HTMLElement){const s=e;e=d=>s.textContent=d||""}this._boundAttributes[r].push(e),this.has(r)&&e.call(this,this._attributes[r])}static extend(r){const e=this;class s extends e{}for(const d in r){const L=Object.getOwnPropertyDescriptor(r,d);L&&Object.defineProperty(s.prototype,d,L)}return Object.assign(s,e),s.__super__=e.prototype,s}}p.prototype.defaults={},t.Widget=p;class u extends p{get className(){return l("panel")}render(){this.tab=document.createElement("a"),this.tab.classList.add(l("tab")),this.icon=document.createElement("i"),this.tab.append(this.icon),this.bindAttr("icon",function(e){e?this.icon.className=`phpdebugbar-icon phpdebugbar-icon-${e}`:this.icon.className=""});const r=document.createElement("span");r.classList.add(l("text")),this.tab.append(r),this.bindAttr("title",r),this.badge=document.createElement("span"),this.badge.classList.add(l("badge")),this.tab.append(this.badge),this.bindAttr("badge",function(e){e!==null?(this.badge.textContent=e,this.badge.classList.add(l("visible"))):this.badge.classList.remove(l("visible"))}),this.bindAttr("widget",function(e){this.el.innerHTML="",this.el.append(e.el)}),this.bindAttr("data",function(e){this.has("widget")&&(this.get("widget").set("data",e),this.tab.setAttribute("data-empty",Object.keys(e).length===0||e.count===0))})}}class f extends p{get tagName(){return"span"}get className(){return l("indicator")}render(){this.icon=document.createElement("i"),this.el.append(this.icon),this.bindAttr("icon",function(e){e?this.icon.className=`phpdebugbar-icon phpdebugbar-icon-${e}`:this.icon.className=""}),this.bindAttr("link",function(e){e?(this.el.addEventListener("click",()=>{this.get("debugbar").showTab(e)}),this.el.style.cursor="pointer"):this.el.style.cursor=""});const r=document.createElement("span");r.classList.add(l("text")),this.el.append(r),this.bindAttr(["title","data"],r),this.tooltip=document.createElement("span"),this.tooltip.classList.add(l("tooltip"),l("disabled")),this.el.append(this.tooltip),this.bindAttr("tooltip",function(e){if(e)if(Array.isArray(e)||typeof e=="object"){const s=document.createElement("dl");for(const[d,L]of Object.entries(e)){const g=document.createElement("dt");g.textContent=d,s.append(g);const n=document.createElement("dd");n.textContent=L,s.append(n)}this.tooltip.innerHTML="",this.tooltip.append(s),this.tooltip.classList.remove(l("disabled"))}else this.tooltip.textContent=e,this.tooltip.classList.remove(l("disabled"));else this.tooltip.classList.add(l("disabled"))})}}class i extends p{constructor(){super(...arguments);N(this,"settings",{})}get tagName(){return"form"}get className(){return l("settings")}initialize(e){this.set(e);const s=this.get("debugbar");this.settings=JSON.parse(localStorage.getItem("phpdebugbar-settings"))||{};for(const d in s.options)d in this.settings&&(s.options[d]=this.settings[d]),d==="theme"?s.setTheme(s.options[d]):s.el.setAttribute(`data-${d}`,s.options[d])}clearSettings(){const e=this.get("debugbar");if(localStorage.removeItem("phpdebugbar-settings"),localStorage.removeItem("phpdebugbar-ajaxhandler-autoshow"),this.settings={},e.options=I({},e.defaultOptions),e.ajaxHandler){const s=e.ajaxHandler.defaultAutoShow;e.ajaxHandler.setAutoShow(s),this.set("autoshow",s),e.controls.__datasets&&e.controls.__datasets.get("widget").set("autoshow",this.autoshow.checked)}this.initialize(e.options)}storeSetting(e,s){this.settings[e]=s;const d=this.get("debugbar");d.options[e]=s,e!=="theme"&&d.el.setAttribute(`data-${e}`,s),localStorage.setItem("phpdebugbar-settings",JSON.stringify(this.settings))}render(){this.el.innerHTML="";const e=this.get("debugbar"),s=this,d={},L=document.createElement("select");L.innerHTML='<option value="auto">Auto (System preference)</option><option value="light">Light</option><option value="dark">Dark</option>',L.value=e.options.theme,L.addEventListener("change",function(){s.storeSetting("theme",this.value),e.setTheme(this.value)}),d.Theme=L;const g=document.createElement("select");g.innerHTML='<option value="bottomLeft">Bottom Left</option><option value="bottomRight">Bottom Right</option><option value="topLeft">Top Left</option><option value="topRight">Top Right</option>',g.value=e.options.openBtnPosition,g.addEventListener("change",function(){s.storeSetting("openBtnPosition",this.value)}),d["Open Button Position"]=g,this.hideEmptyTabs=document.createElement("input"),this.hideEmptyTabs.type="checkbox",this.hideEmptyTabs.checked=e.options.hideEmptyTabs,this.hideEmptyTabs.addEventListener("click",function(){s.storeSetting("hideEmptyTabs",this.checked)});const n=document.createElement("label");n.append(this.hideEmptyTabs,"Hide empty tabs until they have data"),d["Hide Empty Tabs"]=n,this.autoshow=document.createElement("input"),this.autoshow.type="checkbox",this.autoshow.checked=e.ajaxHandler&&e.ajaxHandler.autoShow,this.autoshow.addEventListener("click",function(){e.ajaxHandler&&e.ajaxHandler.setAutoShow(this.checked),e.controls.__datasets&&e.controls.__datasets.get("widget").set("autoshow",this.checked)}),this.bindAttr("autoshow",function(){this.autoshow.checked=this.get("autoshow"),this.autoshow.closest(`.${l("form-row")}`).style.display=""});const o=document.createElement("label");o.append(this.autoshow,"Automatically show new incoming Ajax requests"),d.Autoshow=o;const m=document.createElement("button");m.textContent="Reset settings",m.addEventListener("click",a=>{a.preventDefault(),s.clearSettings(),s.render()}),d["Reset to defaults"]=m;for(const[a,h]of Object.entries(d)){const b=document.createElement("div");b.classList.add(l("form-row"));const x=document.createElement("div");x.classList.add(l("form-label")),x.textContent=a,b.append(x);const w=document.createElement("div");w.classList.add(l("form-input")),h instanceof HTMLElement?w.append(h):w.innerHTML=h,b.append(w),s.el.append(b)}this.ajaxHandler||(this.autoshow.closest(`.${l("form-row")}`).style.display="none")}}class E{constructor(r){this.debugbar=r}format(r,e,s,d){if(s=s?` ${s}`:"",d=d||Object.keys(this.debugbar.datasets).length,e.__meta===void 0)return`#${d}${s}`;const L=e.__meta.uri.split("/");let g=L.pop();g||(g=`${L.pop()||""}/`),L.length&&!isNaN(g)&&(g=`${L.pop()}/${g}`);const n=150;return g.length>n&&(g=`${g.substr(0,n)}...`),`#${d} ${g}${s} (${e.__meta.datetime.split(" ")[1]})`}}t.DatasetTitleFormater=E;class c extends p{constructor(){super(...arguments);N(this,"options",{bodyMarginBottom:!0,theme:"auto",openBtnPosition:"bottomLeft",hideEmptyTabs:!1})}get className(){return`phpdebugbar ${l("minimized")}`}initialize(e={}){this.options=Object.assign({},this.options,e),this.defaultOptions=I({},this.options),this.controls={},this.dataMap={},this.datasets={},this.firstTabName=null,this.activePanelName=null,this.activeDatasetId=null,this.datesetTitleFormater=new E(this);const s=window.getComputedStyle(document.body);this.bodyMarginBottomHeight=Number.parseInt(s.marginBottom);try{this.isIframe=window.self!==window.top&&window.top.phpdebugbar}catch(d){this.isIframe=!1}this.registerResizeHandler(),this.registerMediaListener(),this.settings=new t.DebugBar.Tab({icon:"adjustments-horizontal",title:"Settings",widget:new i({debugbar:this})})}registerResizeHandler(){if(this.resize.bind===void 0||this.isIframe)return;const e=this.resize.bind(this);this.respCSSSize=0,window.addEventListener("resize",e),setTimeout(e,20)}registerMediaListener(){window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",s=>{this.options.theme==="auto"&&this.setTheme("auto")})}setTheme(e){this.options.theme=e,e==="auto"&&(e=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),this.el.setAttribute("data-theme",e),this.openHandler&&this.openHandler.el.setAttribute("data-theme",e)}resize(){if(this.isIframe)return;let e=this.respCSSSize;if(this.respCSSSize===0){const n=Array.from(this.header.children).filter(o=>o.offsetParent!==null);for(const o of n){const m=window.getComputedStyle(o);e+=o.offsetWidth+parseFloat(m.marginLeft)+parseFloat(m.marginRight)}}const s=this.header.offsetWidth,d=l("mini-design"),L=this.header.classList.contains(d);s<=e&&!L?(this.respCSSSize=e,this.header.classList.add(d)):e<s&&L&&(this.respCSSSize=0,this.header.classList.remove(d));const g=this.body.clientHeight||parseInt(localStorage.getItem("phpdebugbar-height"),10)||300;this.setHeight(g)}render(){this.isIframe&&(this.el.style.display="none");const e=this;document.body.append(this.el),this.dragCapture=document.createElement("div"),this.dragCapture.classList.add(l("drag-capture")),this.el.append(this.dragCapture),this.resizeHandle=document.createElement("div"),this.resizeHandle.classList.add(l("resize-handle")),this.el.append(this.resizeHandle),this.header=document.createElement("div"),this.header.classList.add(l("header")),this.el.append(this.header),this.headerBtn=document.createElement("a"),this.headerBtn.classList.add(l("restore-btn")),this.header.append(this.headerBtn),this.headerBtn.addEventListener("click",()=>{e.close()}),this.headerLeft=document.createElement("div"),this.headerLeft.classList.add(l("header-left")),this.header.append(this.headerLeft),this.headerRight=document.createElement("div"),this.headerRight.classList.add(l("header-right")),this.header.append(this.headerRight),this.body=document.createElement("div"),this.body.classList.add(l("body")),this.el.append(this.body),this.recomputeBottomOffset();let s,d;const L=n=>{const o=d+(s-n.pageY);e.setHeight(o)},g=()=>{document.removeEventListener("mousemove",L),document.removeEventListener("mouseup",g),e.dragCapture.style.display="none"};this.resizeHandle.addEventListener("mousedown",n=>{d=e.body.offsetHeight,s=n.pageY,document.addEventListener("mousemove",L),document.addEventListener("mouseup",g),e.dragCapture.style.display="",n.preventDefault()}),this.closebtn=document.createElement("a"),this.closebtn.classList.add(l("close-btn")),this.headerRight.append(this.closebtn),this.closebtn.addEventListener("click",()=>{e.close()}),this.minimizebtn=document.createElement("a"),this.minimizebtn.classList.add(l("minimize-btn")),this.headerRight.append(this.minimizebtn),this.minimizebtn.addEventListener("click",()=>{e.minimize()}),this.maximizebtn=document.createElement("a"),this.maximizebtn.classList.add(l("maximize-btn")),this.headerRight.append(this.maximizebtn),this.maximizebtn.addEventListener("click",()=>{e.restore()}),this.restorebtn=document.createElement("a"),this.restorebtn.classList.add(l("restore-btn")),this.restorebtn.style.display="none",this.el.append(this.restorebtn),this.restorebtn.addEventListener("click",()=>{e.restore()}),this.openbtn=document.createElement("a"),this.openbtn.classList.add(l("open-btn")),this.openbtn.style.display="none",this.headerRight.append(this.openbtn),this.openbtn.addEventListener("click",()=>{e.openHandler.show((n,o)=>{e.addDataSet(o,n,"(opened)"),e.showTab()})}),this.datasetsSelect=document.createElement("select"),this.datasetsSelect.classList.add(l("datasets-switcher")),this.datasetsSelect.setAttribute("name","datasets-switcher"),this.headerRight.append(this.datasetsSelect),this.datasetsSelect.addEventListener("change",function(){e.showDataSet(this.value)}),this.controls.__settings=this.settings,this.settings.tab.classList.add(l("tab-settings")),this.settings.tab.setAttribute("data-collector","__settings"),this.settings.el.setAttribute("data-collector","__settings"),this.maximizebtn.after(this.settings.tab),this.settings.tab.style.display="",this.settings.tab.addEventListener("click",()=>{!this.isMinimized()&&this.activePanelName==="__settings"?this.minimize():(this.showTab("__settings"),this.settings.get("widget").render())}),this.body.append(this.settings.el)}setHeight(e){const d=window.innerHeight-this.header.offsetHeight-10;e=Math.min(e,d),e=Math.max(e,40),this.body.style.height=`${e}px`,localStorage.setItem("phpdebugbar-height",e),this.recomputeBottomOffset()}restoreState(){if(this.isIframe)return;const e=localStorage.getItem("phpdebugbar-height");this.setHeight(parseInt(e)||this.body.offsetHeight);const s=localStorage.getItem("phpdebugbar-open");if(s&&s==="0")this.close();else{const d=localStorage.getItem("phpdebugbar-visible");if(d&&d==="1"){const L=localStorage.getItem("phpdebugbar-tab");this.isTab(L)?this.showTab(L):this.showTab()}}}createTab(e,s,d){const L=new u({title:d||e.replace(/[_-]/g," ").charAt(0).toUpperCase()+e.slice(1),widget:s});return this.addTab(e,L)}addTab(e,s){if(this.isControl(e))throw new Error(`${e} already exists`);const d=this;return this.headerLeft.append(s.tab),s.tab.addEventListener("click",()=>{!d.isMinimized()&&d.activePanelName===e?d.minimize():d.showTab(e)}),s.tab.setAttribute("data-empty",!0),s.tab.setAttribute("data-collector",e),s.el.setAttribute("data-collector",e),this.body.append(s.el),this.controls[e]=s,this.firstTabName===null&&(this.firstTabName=e),s}createIndicator(e,s,d,L){const g=new f({icon:s,tooltip:d});return this.addIndicator(e,g,L)}addIndicator(e,s,d){if(this.isControl(e))throw new Error(`${e} already exists`);return s.set("debugbar",this),d==="left"?this.headerLeft.prepend(s.el):this.headerRight.append(s.el),this.controls[e]=s,s}getControl(e){if(this.isControl(e))return this.controls[e]}isControl(e){return this.controls[e]!==void 0}isTab(e){return this.isControl(e)&&this.controls[e]instanceof u}isIndicator(e){return this.isControl(e)&&this.controls[e]instanceof f}reset(){this.minimize();for(const[e,s]of Object.entries(this.controls))this.isTab(e)&&s.tab.remove(),s.el.remove();this.controls={}}showTab(e){if(e||(this.activePanelName?e=this.activePanelName:e=this.firstTabName),!this.isTab(e))throw new Error(`Unknown tab '${e}'`);this.resizeHandle.style.display="block",this.body.style.display="block",this.recomputeBottomOffset();const s=l("active"),d=this.header.querySelectorAll(` div > .${s}`);for(const g of d)g.classList.remove(s);const L=this.body.querySelectorAll(`:scope > .${s}`);for(const g of L)g.classList.remove(s);this.controls[e].tab.classList.add(s),this.controls[e].el.classList.add(s),this.activePanelName=e,this.el.classList.remove(l("minimized")),localStorage.setItem("phpdebugbar-visible","1"),localStorage.setItem("phpdebugbar-tab",e),this.resize()}minimize(){const e=l("active"),s=this.header.querySelectorAll(`:scope > div > .${e}`);for(const d of s)d.classList.remove(e);this.body.style.display="none",this.resizeHandle.style.display="none",this.recomputeBottomOffset(),localStorage.setItem("phpdebugbar-visible","0"),this.el.classList.add(l("minimized")),this.resize()}isMinimized(){return this.el.classList.contains(l("minimized"))}close(){this.resizeHandle.style.display="none",this.header.style.display="none",this.body.style.display="none",this.restorebtn.style.display="",localStorage.setItem("phpdebugbar-open","0"),this.el.classList.add(l("closed")),this.recomputeBottomOffset()}isClosed(){return this.el.classList.contains(l("closed"))}restore(){this.resizeHandle.style.display="block",this.header.style.display="block",this.restorebtn.style.display="none",localStorage.setItem("phpdebugbar-open","1");const e=localStorage.getItem("phpdebugbar-tab");this.isTab(e)?this.showTab(e):this.showTab(),this.el.classList.remove(l("closed")),this.resize()}recomputeBottomOffset(){if(this.options.bodyMarginBottom){if(this.isClosed()){document.body.style.marginBottom=this.bodyMarginBottomHeight?`${this.bodyMarginBottomHeight}px`:"";return}const e=this.el.offsetHeight+(this.bodyMarginBottomHeight||0);document.body.style.marginBottom=`${e}px`}}setDataMap(e){this.dataMap=e}addDataMap(e){Object.assign(this.dataMap,e)}setData(e){return this.datasets={},this.addDataSet(e)}addDataSet(e,s,d,L){if(!e||!e.__meta)return;if(this.isIframe){window.top.phpdebugbar.addDataSet(e,s,`(iframe)${d||""}`,L);return}const g=Object.keys(this.datasets).length+1;s=s||g,e.__meta.nb=g,e.__meta.suffix=d,this.datasets[s]=e;const n=this.datesetTitleFormater.format(s,this.datasets[s],d,g);if(this.datasetTab){this.datasetTab.set("data",this.datasets);const m=Object.keys(this.datasets).length;this.datasetTab.set("badge",m>1?m:null),this.datasetTab.tab.style.display=""}const o=document.createElement("option");return o.value=s,o.textContent=n,this.datasetsSelect.append(o),this.datasetsSelect.children.length>1&&(this.datasetsSelect.style.display="block"),(L===void 0||L)&&this.showDataSet(s),this.resize(),s}loadDataSet(e,s,d,L){if(!this.openHandler)throw new Error("loadDataSet() needs an open handler");const g=this;this.openHandler.load(e,n=>{g.addDataSet(n,e,s,L),g.resize(),d&&d(n)})}getDataSet(e){return this.datasets[e]}showDataSet(e){this.activeDatasetId=e,this.dataChangeHandler(this.datasets[e]),this.datasetsSelect.value!==e&&(this.datasetsSelect.value=e),this.datasetTab&&this.datasetTab.get("widget").set("id",e)}dataChangeHandler(e){for(const[s,d]of Object.entries(this.dataMap)){const L=k(e,d[0],d[1]);if(s.includes(":")){const g=s.split(":");this.getControl(g[0]).set(g[1],L)}else this.getControl(s).set("data",L)}this.resize()}setOpenHandler(e){this.openHandler=e,this.openHandler.el.setAttribute("data-theme",this.el.getAttribute("data-theme")),e!==null?this.openbtn.style.display="":this.openbtn.style.display="none"}getOpenHandler(){return this.openHandler}enableAjaxHandlerTab(){this.datasetTab=new t.DebugBar.Tab({icon:"history",title:"Request history",widget:new t.Widgets.DatasetWidget({debugbar:this})}),this.datasetTab.tab.classList.add(l("tab-history")),this.datasetTab.tab.setAttribute("data-collector","__datasets"),this.datasetTab.el.setAttribute("data-collector","__datasets"),this.openbtn.after(this.datasetTab.tab),this.datasetTab.tab.style.display="none",this.datasetTab.tab.addEventListener("click",()=>{!this.isMinimized()&&this.activePanelName==="__datasets"?this.minimize():this.showTab("__datasets")}),this.body.append(this.datasetTab.el),this.controls.__datasets=this.datasetTab}}t.DebugBar=c,c.Tab=u,c.Indicator=f;class _{constructor(r,e,s){this.debugbar=r,this.headerName=e||"phpdebugbar",this.autoShow=s===void 0?!0:s,this.defaultAutoShow=this.autoShow,localStorage.getItem("phpdebugbar-ajaxhandler-autoshow")!==null&&(this.autoShow=localStorage.getItem("phpdebugbar-ajaxhandler-autoshow")==="1"),r.controls.__settings&&r.controls.__settings.get("widget").set("autoshow",this.autoShow)}handle(r){return!!(this.loadFromId(r)||this.loadFromData(r))}getHeader(r,e){if(r instanceof Response)return r.headers.get(e);if(r instanceof XMLHttpRequest)return r.getResponseHeader(e)}setAutoShow(r){this.autoShow=r,localStorage.setItem("phpdebugbar-ajaxhandler-autoshow",r?"1":"0")}loadFromId(r){const e=this.extractIdFromHeaders(r);return e&&this.debugbar.openHandler?(this.debugbar.loadDataSet(e,"(ajax)",void 0,this.autoShow),!0):!1}extractIdFromHeaders(r){return this.getHeader(r,`${this.headerName}-id`)}loadFromData(r){const e=this.extractDataFromHeaders(r);if(!e)return!1;const s=this.parseHeaders(e);if(s.error)throw new Error(`Error loading debugbar data: ${s.error}`);return s.data&&this.debugbar.addDataSet(s.data,s.id,"(ajax)",this.autoShow),!0}extractDataFromHeaders(r){let e=this.getHeader(r,this.headerName);if(e){for(let s=1;;s++){const d=this.getHeader(r,`${this.headerName}-${s}`);if(!d)break;e+=d}return decodeURIComponent(e)}}parseHeaders(r){return JSON.parse(r)}bindToFetch(){const r=this,e=window.fetch;e!==void 0&&e.polyfill!==void 0||(window.fetch=function(...s){const d=e.apply(window,s);return d.then(L=>{r.handle(L)}).catch(L=>{}),d})}bindToXHR(){const r=this,e=XMLHttpRequest.prototype.open;XMLHttpRequest.prototype.open=function(s,d,L,g,n){const o=this;o.addEventListener("readystatechange",()=>{o.readyState===4&&r.handle(o)},!1),e.apply(o,[s,d,L,g,n])}}}t.AjaxHandler=_})();(function(){PhpDebugBar.Widgets={};const t=PhpDebugBar.utils.makecsscls("phpdebugbar-widgets-"),k=PhpDebugBar.Widgets.htmlize=function(g){return g.replace(/\n/g,"<br>").replace(/\s/g,"&nbsp;")},l=PhpDebugBar.Widgets.renderValue=function(g,n){return typeof g!="string"?n?k(JSON.stringify(g,void 0,2)):JSON.stringify(g):g},p=PhpDebugBar.Widgets.highlight=function(g,n){if(typeof g=="string"){if(typeof phpdebugbar_hljs=="undefined")return k(g);const o=phpdebugbar_hljs.default||phpdebugbar_hljs;return n&&o.getLanguage(n)?o.highlight(g,{language:n}).value:o.highlightAuto(g).value}if(typeof phpdebugbar_hljs=="object"){const o=phpdebugbar_hljs.default||phpdebugbar_hljs;if(g.nodeType===Node.ELEMENT_NODE)o.highlightElement(g);else if(g.length)for(const m of g)o.highlightElement(m)}return g},u=PhpDebugBar.Widgets.createCodeBlock=function(g,n,o,m){const a=document.createElement("pre");a.classList.add(t("code-block"));const h=document.createElement("code");if(h.textContent=`${g}
`,a.append(h),n&&h.classList.add(`language-${n}`),p(h),h.classList.remove("hljs"),!isNaN(Number.parseFloat(o))){const b=g.split(`
`).length,x=document.createElement("ul");a.prepend(x);const w=Array.from(a.children);for(const S of w)S.classList.add(t("numbered-code"));for(let S=o;S<o+b;S++){const C=document.createElement("li");if(C.textContent=S,x.append(C),m===S){C.classList.add(t("highlighted-line"));const v=document.createElement("span");v.innerHTML="&nbsp;",C.append(v)}}}return a},{getDictValue:f}=PhpDebugBar.utils;class i extends PhpDebugBar.Widget{get tagName(){return"ul"}get className(){return t("list")}initialize(n){n.itemRenderer||(n.itemRenderer=this.itemRenderer),this.set(n)}render(){this.bindAttr(["itemRenderer","data"],function(){if(this.el.innerHTML="",!this.has("data"))return;const n=this.get("data");for(let o=0;o<n.length;o++){const m=document.createElement("li");m.classList.add(t("list-item")),this.el.append(m),this.get("itemRenderer")(m,n[o])}})}itemRenderer(n,o){n.innerHTML=l(o)}}PhpDebugBar.Widgets.ListWidget=i;class E extends i{get tagName(){return"dl"}get className(){return t("kvlist")}render(){this.bindAttr(["itemRenderer","data"],function(){if(this.el.innerHTML="",!!this.has("data"))for(const[n,o]of Object.entries(this.get("data"))){const m=document.createElement("dt");m.classList.add(t("key")),this.el.append(m);const a=document.createElement("dd");a.classList.add(t("value")),this.el.append(a),this.get("itemRenderer")(m,a,n,o)}})}itemRenderer(n,o,m,a){n.textContent=m,o.innerHTML=k(a)}}PhpDebugBar.Widgets.KVListWidget=E;class c extends E{get className(){return t("kvlist varlist")}itemRenderer(n,o,m,a){const h=document.createElement("span");h.setAttribute("title",m),h.textContent=m,n.append(h);let b=a&&a.value||a;b&&b.length>100&&(b=`${b.substr(0,100)}...`);let x=null;o.textContent=b,o.addEventListener("click",()=>{if(window.getSelection().type==="Range")return"";o.classList.contains(t("pretty"))?(o.textContent=b,o.classList.remove(t("pretty"))):(x=x||u(a),o.classList.add(t("pretty")),o.innerHTML="",o.append(x))})}}PhpDebugBar.Widgets.VariableListWidget=c;class _ extends E{get className(){return t("kvlist htmlvarlist")}itemRenderer(n,o,m,a){const h=document.createElement("i");h.innerHTML=m!=null?m:"";const b=document.createElement("span");if(b.setAttribute("title",h.textContent),b.innerHTML=m!=null?m:"",n.append(b),o.innerHTML=a&&a.value||a,a&&a.xdebug_link){const x=document.createElement("span");if(x.classList.add(t("filename")),x.textContent=a.xdebug_link.filename+(a.xdebug_link.line?`#${a.xdebug_link.line}`:""),a.xdebug_link){const w=document.createElement("a");w.classList.add(t("editor-link")),a.xdebug_link.ajax?(w.setAttribute("title",a.xdebug_link.url),w.addEventListener("click",()=>{fetch(a.xdebug_link.url)})):w.setAttribute("href",a.xdebug_link.url),x.append(w)}o.append(x)}}}PhpDebugBar.Widgets.HtmlVariableListWidget=_;class y extends PhpDebugBar.Widget{get tagName(){return"div"}get className(){return t("tablevarlist")}render(){this.bindAttr("data",function(n){var w,S,C;if(this.el.innerHTML="",!this.has("data"))return;this.table=document.createElement("table"),this.table.classList.add(t("tablevar")),this.el.append(this.table);const o=document.createElement("tr");o.classList.add(t("header"));const m=document.createElement("td");o.append(m),this.table.append(o);let a=n.key_map||{value:"Value"};Array.isArray(a)&&(a=Object.fromEntries(a.map(v=>[v,null])));for(const[v,T]of Object.entries(a)){const D=document.createElement("td");if(D.textContent=T!=null?T:v,o.append(D),n.badges&&n.badges[v]){const H=document.createElement("span");H.textContent=n.badges[v],H.classList.add(t("badge")),D.append(H)}}const h=this;if(!n.data)return;for(const[v,T]of Object.entries(n.data)){const D=document.createElement("tr");D.classList.add(t("item")),h.table.append(D);const H=document.createElement("td");if(H.classList.add(t("key")),H.textContent=v,D.append(H),typeof T!="object"||T===null){const $=document.createElement("td");$.classList.add(t("value")),$.textContent=T!=null?T:"",D.append($);continue}for(const $ of Object.keys(a)){const A=document.createElement("td");A.classList.add(t("value")),A.textContent=(w=T[$])!=null?w:"",D.append(A)}if(T.xdebug_link){const $=document.createElement("td");$.classList.add(t("editor")),D.append($);const A=document.createElement("span");A.classList.add(t("filename")),A.textContent=T.xdebug_link.filename+(T.xdebug_link.line?`#${T.xdebug_link.line}`:""),$.append(A);const M=document.createElement("a");M.classList.add(t("editor-link")),T.xdebug_link.ajax?(M.setAttribute("title",T.xdebug_link.url),M.addEventListener("click",()=>{fetch(T.xdebug_link.url)})):M.setAttribute("href",T.xdebug_link.url),A.append(M),n.xdebug_link||(n.xdebug_link=!0,o.append(document.createElement("td")))}}if(!n.summary)return;const b=document.createElement("tr");b.classList.add(t("summary")),h.table.append(b);const x=document.createElement("td");if(x.classList.add(t("key")),b.append(x),typeof n.summary!="object"||n.summary===null){const v=document.createElement("td");v.classList.add(t("value")),v.textContent=(S=n.summary)!=null?S:"",b.append(v)}else for(const v of Object.keys(a)){const T=document.createElement("td");T.classList.add(t("value")),T.textContent=(C=n.summary[v])!=null?C:"",b.append(T)}n.xdebug_link&&b.append(document.createElement("td"))})}}PhpDebugBar.Widgets.TableVariableListWidget=y;class r extends PhpDebugBar.Widget{get tagName(){return"iframe"}get className(){return t("iframe")}render(){this.el.setAttribute("seamless","seamless"),this.el.setAttribute("border","0"),this.el.setAttribute("width","100%"),this.el.setAttribute("height","100%"),this.bindAttr("data",function(n){this.el.setAttribute("src",n)})}}PhpDebugBar.Widgets.IFrameWidget=r;class e extends PhpDebugBar.Widget{get className(){return t("messages")}render(){const n=this;this.list=new i({itemRenderer(m,a){let h;if(a.message_html)h=document.createElement("span"),h.classList.add(t("value")),h.innerHTML=a.message_html,m.append(h);else{let b=a.message;if(b.length>100&&(b=`${b.substr(0,100)}...`),h=document.createElement("span"),h.classList.add(t("value")),h.textContent=b,m.append(h),!a.is_string||a.message.length>100){let x=a.message;a.is_string||(x=null),m.style.cursor="pointer",m.addEventListener("click",()=>{if(window.getSelection().type==="Range")return"";h.classList.contains(t("pretty"))?(h.textContent=b,h.classList.remove(t("pretty"))):(x=x||u(a.message,"php"),h.classList.add(t("pretty")),h.innerHTML="",h.append(x))})}}if(a.xdebug_link){const b=document.createElement("span");if(b.classList.add(t("filename")),b.textContent=a.xdebug_link.filename+(a.xdebug_link.line?`#${a.xdebug_link.line}`:""),a.xdebug_link){const x=document.createElement("a");x.classList.add(t("editor-link")),a.xdebug_link.ajax?(x.setAttribute("title",a.xdebug_link.url),x.addEventListener("click",()=>{fetch(a.xdebug_link.url)})):x.setAttribute("href",a.xdebug_link.url),b.append(x)}m.prepend(b)}if(a.collector){const b=document.createElement("span");b.classList.add(t("collector")),b.textContent=a.collector,m.prepend(b)}if(a.label){h.classList.add(t(a.label));const b=document.createElement("span");b.classList.add(t("label")),b.textContent=a.label,m.prepend(b)}}}),this.el.append(this.list.el),this.toolbar=document.createElement("div"),this.toolbar.classList.add(t("toolbar")),this.toolbar.innerHTML='<i class="phpdebugbar-icon phpdebugbar-icon-search"></i>',this.el.append(this.toolbar);const o=document.createElement("input");o.type="text",o.name="search",o.setAttribute("aria-label","Search"),o.placeholder="Search",o.addEventListener("change",function(){n.set("search",this.value)}),this.toolbar.append(o),this.bindAttr("data",function(m){this.set({excludelabel:[],excludecollector:[],search:""});const a=this.toolbar.querySelectorAll(`.${t("filter")}`);for(const C of a)C.remove();const h=[],b=[],x=this,w=function(C,v){const T=document.createElement("a");T.classList.add(t("filter")),T.classList.add(t(C)),T.textContent=v,T.setAttribute("rel",v),T.addEventListener("click",function(){x.onFilterClick(this,C)}),x.toolbar.append(T)};if(m.forEach(C=>{h.includes(C.label||"none")||h.push(C.label||"none"),b.includes(C.collector||"none")||b.push(C.collector||"none")}),h.length>1&&h.forEach(C=>w("label",C)),b.length===1)return;const S=document.createElement("a");S.classList.add(t("filter")),S.style.visibility="hidden",x.toolbar.append(S),b.forEach(C=>w("collector",C))}),this.bindAttr(["excludelabel","excludecollector","search"],function(){const m=this.get("excludelabel")||[],a=this.get("excludecollector")||[],h=this.get("search");let b=!1;const x=[];h&&h===h.toLowerCase()&&(b=!0),this.get("data").forEach(w=>{const S=b?w.message.toLowerCase():w.message;!m.includes(w.label||void 0)&&!a.includes(w.collector||void 0)&&(!h||S.includes(h))&&x.push(w)}),this.list.set("data",x)})}onFilterClick(n,o){n.classList.toggle(t("excluded"));const m=[],a=`.${t("filter")}.${t("excluded")}.${t(o)}`,h=this.toolbar.querySelectorAll(a);for(const b of h)m.push(b.rel==="none"||!b.rel?void 0:b.rel);this.set(`exclude${o}`,m)}}PhpDebugBar.Widgets.MessagesWidget=e;class s extends PhpDebugBar.Widget{get tagName(){return"ul"}get className(){return t("timeline")}render(){this.bindAttr("data",function(n){const o=function(a){return a<.001?`${(a*1e6).toFixed()}\u03BCs`:a<.1?`${(a*1e3).toFixed(2)}ms`:a<1?`${(a*1e3).toFixed()}ms`:`${a.toFixed(2)}s`},m=function(h){if(h===0||h===null)return"0B";const b=h<0?"-":"",x=Math.abs(h),w=Math.log(x)/Math.log(1024),S=["B","KB","MB","GB","TB"];return b+Math.round(O(1024,w-Math.floor(w))*100)/100+S[Math.floor(w)]};if(this.el.innerHTML="",n.measures){let a={};for(let x=0;x<n.measures.length;x++){const w=n.measures[x],S=w.group||w.label;a[S]||(a[S]={count:0,duration:0,memory:0}),a[S].count+=1,a[S].duration+=w.duration,a[S].memory+=w.memory||0;const C=document.createElement("div");C.classList.add(t("measure"));const v=document.createElement("li"),T=(w.relative_start*100/n.duration).toFixed(2),D=Math.min((w.duration*100/n.duration).toFixed(2),100-T),H=document.createElement("span");H.classList.add(t("value")),H.style.left=`${T}%`,H.style.width=`${D}%`,C.append(H);const $=document.createElement("span");if($.classList.add(t("label")),$.textContent=w.label.replace(/\s+/g," ")+(w.duration?` (${w.duration_str}${w.memory?`/${w.memory_str}`:""})`:""),C.append($),w.collector){const A=document.createElement("span");A.classList.add(t("collector")),A.textContent=w.collector,C.append(A)}if(v.append(C),this.el.append(v),w.params&&Object.keys(w.params).length>0){const A=document.createElement("table");A.classList.add(t("params")),A.style.display="none",A.innerHTML='<tr><th colspan="2">Params</th></tr>';for(const M in w.params)if(typeof w.params[M]!="function"){const B=document.createElement("tr");B.innerHTML=`<td class="${t("name")}">${M}</td><td class="${t("value")}"><pre><code>${w.params[M]}</code></pre></td>`,A.append(B)}v.append(A),v.style.cursor="pointer",v.addEventListener("click",function(){if(window.getSelection().type==="Range")return"";const M=this.querySelector("table");M.style.display!=="none"?M.style.display="none":M.style.display=""}),v.addEventListener("click",M=>{M.target.closest(".sf-dump")&&M.stopPropagation()})}}a=Object.entries(a).map(([x,w])=>({label:x,data:w})).sort((x,w)=>w.data.duration-x.data.duration);const h=document.createElement("table");h.classList.add(t("params"));for(const x of a){const w=Math.min((x.data.duration*100/n.duration).toFixed(2),100),S=document.createElement("i");S.textContent=x.label.replace(/\s+/g," ");const C=S.innerHTML,v=document.createElement("tr");v.innerHTML=`<td class="${t("name")}">${x.data.count} x ${C} (${w}%)</td><td class="${t("value")}"><div class="${t("measure")}"><span class="${t("value")}"></span><span class="${t("label")}">${o(x.data.duration)}${x.data.memory?`/${m(x.data.memory)}`:""}</span></div></td>`,h.append(v);const T=v.querySelector(`span.${t("value")}`);T.style.width=`${w}%`}const b=document.createElement("li");b.append(h),this.el.append(b)}})}}PhpDebugBar.Widgets.TimelineWidget=s;class d extends PhpDebugBar.Widget{get className(){return t("exceptions")}render(){this.list=new i({itemRenderer(n,o){const m=document.createElement("span");if(m.classList.add(t("message")),m.textContent=o.message,o.count>1){const a=document.createElement("span");a.classList.add(t("badge")),a.textContent=`${o.count}x`,m.prepend(a)}if(n.append(m),o.file){const a=document.createElement("span");if(a.classList.add(t("filename")),a.textContent=`${o.file}#${o.line}`,o.xdebug_link){const h=document.createElement("a");h.classList.add(t("editor-link")),o.xdebug_link.ajax?(h.setAttribute("title",o.xdebug_link.url),h.addEventListener("click",()=>{fetch(o.xdebug_link.url)})):h.setAttribute("href",o.xdebug_link.url),a.append(h)}n.append(a)}if(o.type){const a=document.createElement("span");a.classList.add(t("type")),a.textContent=o.type,n.append(a)}if(o.surrounding_lines){const a=o.line-3<=0?1:o.line-3,h=u(o.surrounding_lines.join(""),"php",a,o.line);h.classList.add(t("file")),n.append(h),o.stack_trace_html||n.addEventListener("click",()=>{h.style.display!=="none"?h.style.display="none":h.style.display=""})}if(o.stack_trace_html){const a=document.createElement("span");a.classList.add(t("filename")),a.innerHTML=o.stack_trace_html;const h=a.querySelectorAll('samp[data-depth="1"]');for(const b of h){b.classList.remove("sf-dump-expanded"),b.classList.add("sf-dump-compact");const x=b.parentElement.querySelector(">.sf-dump-note");x&&(x.innerHTML=x.innerHTML.replace(/^array:/,'<span class="sf-dump-key">Stack Trace:</span> ')+" files")}n.append(a)}else o.stack_trace&&o.stack_trace.split(`
`).forEach(a=>{const h=document.createElement("div"),b=document.createElement("span");b.classList.add(t("filename")),b.textContent=a,h.append(b),n.append(h)})}}),this.el.append(this.list.el),this.bindAttr("data",function(n){if(this.list.set("data",n),n.length===1){const o=this.list.el.children[0];if(o){const m=o.querySelector(`.${t("file")}`);m&&(m.style.display="")}}})}}PhpDebugBar.Widgets.ExceptionsWidget=d;class L extends PhpDebugBar.Widget{initialize(n){n.itemRenderer||(n.itemRenderer=this.itemRenderer),this.set(n),this.set("autoshow",null),this.set("id",null),this.set("sort",localStorage.getItem("debugbar-history-sort")||"asc"),this.el.classList.add(t("dataset-history")),this.renderHead()}renderHead(){this.el.innerHTML="",this.actions=document.createElement("div"),this.actions.classList.add(t("dataset-actions")),this.el.append(this.actions);const n=this,o=n.get("debugbar");this.autoshow=document.createElement("input"),this.autoshow.type="checkbox",this.autoshow.addEventListener("click",function(){o.ajaxHandler&&o.ajaxHandler.setAutoShow(this.checked),o.controls.__settings&&o.controls.__settings.get("widget").set("autoshow",this.autoShow)});const m=document.createElement("label");m.textContent="Autoshow",m.append(this.autoshow),this.actions.append(m),this.clearbtn=document.createElement("a"),this.clearbtn.textContent="Clear",this.actions.append(this.clearbtn),this.clearbtn.addEventListener("click",()=>{n.table.innerHTML=""}),this.showBtn=document.createElement("a"),this.showBtn.textContent="Show all",this.actions.append(this.showBtn),this.showBtn.addEventListener("click",()=>{n.searchInput.value=null,n.methodInput.value=null,n.set("search",null),n.set("method",null)}),this.methodInput=document.createElement("select"),this.methodInput.name="method",this.methodInput.style.width="100px",this.methodInput.innerHTML="<option>(method)</option><option>GET</option><option>POST</option><option>PUT</option><option>DELETE</option>",this.methodInput.addEventListener("change",function(){n.set("method",this.value)}),this.actions.append(this.methodInput),this.searchInput=document.createElement("input"),this.searchInput.type="text",this.searchInput.name="search",this.searchInput.setAttribute("aria-label","Search"),this.searchInput.placeholder="Search",this.searchInput.addEventListener("input",function(){n.set("search",this.value)}),this.actions.append(this.searchInput),this.table=document.createElement("tbody");const a=document.createElement("table"),h=document.createElement("thead"),b=document.createElement("tr"),x=document.createElement("th");x.style.width="30px",b.append(x);const w=document.createElement("th");w.textContent="Date \u2195",w.style.width="175px",w.addEventListener("click",()=>{n.set("sort",n.get("sort")==="asc"?"desc":"asc"),localStorage.setItem("debugbar-history-sort",n.get("sort"))}),b.append(w);const S=document.createElement("th");S.textContent="Method",S.style.width="80px",b.append(S);const C=document.createElement("th");C.textContent="URL",b.append(C);const v=document.createElement("th");v.setAttribute("width","40%"),v.textContent="Data",b.append(v),h.append(b),a.append(h),a.append(this.table),this.el.append(a)}renderDatasets(){this.table.innerHTML="";const n=this,o=this.get("data");if(o)for(const[m,a]of Object.entries(o))a.__meta&&n.get("itemRenderer")(n,a)}render(){this.bindAttr("data",function(){if(this.get("autoshow")===null&&this.get("debugbar").ajaxHandler&&this.set("autoshow",this.get("debugbar").ajaxHandler.autoShow),!this.has("data"))return;const n=this.get("data"),o=n[Object.keys(n)[Object.keys(n).length-1]];o.__meta&&this.get("itemRenderer")(this,o)}),this.bindAttr(["itemRenderer","search","method","sort"],function(){this.renderDatasets()}),this.bindAttr("autoshow",function(){const n=this.get("autoshow");this.autoshow.checked=n}),this.bindAttr("id",function(){const n=this.get("id"),o=t("active"),m=this.table.querySelectorAll(`.${o}`);for(const h of m)h.classList.remove(o);const a=this.table.querySelector(`tr[data-id="${n}"]`);a&&a.classList.add(o)})}itemRenderer(n,o){const m=o.__meta,a=document.createElement("td"),h=document.createElement("tr");n.get("sort")==="asc"?n.table.append(h):n.table.prepend(h);const b=function(){const H=n.get("debugbar");H.showDataSet(m.id,H.datesetTitleFormater.format("",o,m.suffix,m.nb));const $=t("active"),A=n.table.querySelectorAll(`.${$}`);for(const B of A)B.classList.remove($);h.classList.add($);const M=this.dataset.tab;M&&H.showTab(M)};h.setAttribute("data-id",m.id),h.style.cursor="pointer",h.classList.add(t("table-row"));const x=document.createElement("td");x.textContent=`#${m.nb}`,x.addEventListener("click",b),h.append(x);const w=document.createElement("td");w.textContent=m.datetime,w.addEventListener("click",b),h.append(w);const S=document.createElement("td");S.textContent=m.method,S.addEventListener("click",b),h.append(S);const C=document.createElement("td");C.textContent=m.uri+(m.suffix?` ${m.suffix}`:""),C.addEventListener("click",b),h.append(C);const v=n.get("debugbar");for(let[H,$]of Object.entries(v.dataMap)){const A=f(o,$[0],$[1]);if(H.includes(":")){const M=H.split(":");H=M[0];const B=M[1];if(B==="badge"&&A>0){const P=v.getControl(H),j=document.createElement("a");if(j.setAttribute("title",P.get("title")),j.dataset.tab=H,P.icon&&j.append(P.icon.cloneNode(!0)),P.badge){const W=P.badge.cloneNode(!0);W.style.display="inline-block",W.textContent=A,j.append(W)}a.append(j),j.addEventListener("click",b)}else B==="tooltip"&&v.getControl(H).set("tooltip",A)}}h.append(a),v.activeDatasetId===m.id&&h.classList.add(t("active"));const T=n.get("search"),D=n.get("method");(T&&!m.uri.includes(T)||D&&m.method!==D)&&(h.style.display="none")}}PhpDebugBar.Widgets.DatasetWidget=L})();(function(){const t=function(k){return PhpDebugBar.utils.csscls(k,"phpdebugbar-openhandler-")};PhpDebugBar.OpenHandler=PhpDebugBar.Widget.extend({className:"phpdebugbar-openhandler",defaults:{items_per_page:20},render(){const k=this;document.body.append(this.el),this.el.style.display="none",this.closebtn=document.createElement("a"),this.closebtn.innerHTML='<i class="phpdebugbar-icon phpdebugbar-icon-x"></i>',this.table=document.createElement("tbody");const l=document.createElement("div");l.classList.add(t("header")),l.textContent="PHP DebugBar | Open",l.append(this.closebtn),this.el.append(l);const p=document.createElement("table");p.innerHTML='<thead><tr><th width="155">Date</th><th width="75">Method</th><th>URL</th><th width="125">IP</th><th width="100">Filter data</th></tr></thead>',p.append(this.table),this.el.append(p),this.actions=document.createElement("div"),this.actions.classList.add(t("actions")),this.el.append(this.actions),this.closebtn.addEventListener("click",()=>{k.hide()}),this.loadmorebtn=document.createElement("a"),this.loadmorebtn.textContent="Load more",this.actions.append(this.loadmorebtn),this.loadmorebtn.addEventListener("click",()=>{k.find(k.last_find_request,k.last_find_request.offset+k.get("items_per_page"),k.handleFind.bind(k))}),this.showonlycurrentbtn=document.createElement("a"),this.showonlycurrentbtn.textContent="Show only current URL",this.actions.append(this.showonlycurrentbtn),this.showonlycurrentbtn.addEventListener("click",()=>{k.table.innerHTML="",k.find({uri:window.location.pathname},0,k.handleFind.bind(k))}),this.showallbtn=document.createElement("a"),this.showallbtn.textContent="Show all",this.actions.append(this.showallbtn),this.showallbtn.addEventListener("click",()=>{k.refresh()}),this.clearbtn=document.createElement("a"),this.clearbtn.textContent="Delete all",this.actions.append(this.clearbtn),this.clearbtn.addEventListener("click",()=>{k.clear(()=>{k.hide()})}),this.addSearch(),this.overlay=document.createElement("div"),this.overlay.classList.add(t("overlay")),this.overlay.style.display="none",document.body.append(this.overlay),this.overlay.addEventListener("click",()=>{k.hide()})},refresh(){this.table.innerHTML="",this.loadmorebtn.style.display="",this.find({},0,this.handleFind.bind(this))},addSearch(){const k=this,l=document.createElement("button");l.textContent="Search",l.type="submit",l.addEventListener("click",function(i){k.table.innerHTML="";const E={},c=new FormData(this.parentElement);for(const[_,y]of c.entries())y&&(E[_]=y);k.find(E,0,k.handleFind.bind(k)),i.preventDefault()});const p=document.createElement("form");p.innerHTML='<br/><b>Filter results</b><br/><select name="method"><option selected>(Method)</option><option>GET</option><option>POST</option><option>PUT</option><option>DELETE</option></select>';const u=document.createElement("input");u.type="text",u.name="uri",u.placeholder="URI",p.append(u);const f=document.createElement("input");f.type="text",f.name="ip",f.placeholder="IP",p.append(f),p.append(l),this.actions.append(p)},handleFind(k){const l=this;for(const p of k){const u=document.createElement("a");u.textContent="Load dataset",u.addEventListener("click",L=>{l.hide(),l.load(p.id,g=>{l.callback(p.id,g)}),L.preventDefault()});const f=document.createElement("a");f.textContent=p.method,f.addEventListener("click",L=>{l.table.innerHTML="",l.find({method:p.method},0,l.handleFind.bind(l)),L.preventDefault()});const i=document.createElement("a");i.textContent=p.uri,i.addEventListener("click",L=>{l.hide(),l.load(p.id,g=>{l.callback(p.id,g)}),L.preventDefault()});const E=document.createElement("a");E.textContent=p.ip,E.addEventListener("click",L=>{l.table.innerHTML="",l.find({ip:p.ip},0,l.handleFind.bind(l)),L.preventDefault()});const c=document.createElement("a");c.textContent="Show URL",c.addEventListener("click",L=>{l.table.innerHTML="",l.find({uri:p.uri},0,l.handleFind.bind(l)),L.preventDefault()});const _=document.createElement("tr"),y=document.createElement("td");y.textContent=p.datetime,_.append(y);const r=document.createElement("td");r.textContent=p.method,_.append(r);const e=document.createElement("td");e.append(i),_.append(e);const s=document.createElement("td");s.append(E),_.append(s);const d=document.createElement("td");d.append(c),_.append(d),l.table.append(_)}k.length<this.get("items_per_page")&&(this.loadmorebtn.style.display="none")},show(k){this.callback=k,this.el.style.display="block",this.overlay.style.display="block",this.refresh()},hide(){this.el.style.display="none",this.overlay.style.display="none"},find(k,l,p){const u=Object.assign({},k,{max:this.get("items_per_page"),offset:l||0});this.last_find_request=u,this.ajax(u,p)},load(k,l){this.ajax({op:"get",id:k},l)},clear(k){this.ajax({op:"clear"},k)},ajax(k,l){let p=this.get("url");k&&(p=p+(p.includes("?")?"&":"?")+new URLSearchParams(k)),fetch(p,{method:"GET",headers:{Accept:"application/json"}}).then(u=>u.json()).then(l)}})})();(function(){const t=PhpDebugBar.utils.makecsscls("phpdebugbar-widgets-");class k extends PhpDebugBar.Widget{get className(){return t("sqlqueries")}onFilterClick(p){p.classList.toggle(t("excluded"));const u=p.getAttribute("rel"),f=this.list.el.querySelectorAll(`li[connection="${u}"]`);for(const i of f)i.style.display=i.style.display==="none"?"":"none"}onCopyToClipboard(p){const u=p.parentElement.querySelector("code"),f=function(){try{document.execCommand("copy")&&(p.classList.add(t("copy-clipboard-check")),setTimeout(()=>{p.classList.remove(t("copy-clipboard-check"))},2e3))}catch(E){console.log("Oops, unable to copy")}};(function(E){if(document.selection){const c=document.body.createTextRange();c.moveToElementText(E),c.select()}else if(window.getSelection){const c=document.createRange();c.selectNodeContents(E),window.getSelection().removeAllRanges(),window.getSelection().addRange(c)}f(),window.getSelection().removeAllRanges()})(u)}renderList(p,u,f){const i=document.createElement("ul");i.classList.add(t("table-list"));for(const y in f){const r=typeof f[y]=="function"?`${f[y].name} {}`:f[y],e=document.createElement("li");if(e.classList.add(t("table-list-item")),typeof r=="object"&&r!==null){const s=document.createElement("span");if(s.classList.add("phpdebugbar-text-muted"),s.textContent=r.index||y,s.append("."),e.append(s),e.append("\xA0"),r.namespace&&e.append(`${r.namespace}::`),e.append(r.name||r.file),r.line){const d=document.createElement("span");d.classList.add("phpdebugbar-text-muted"),d.textContent=`:${r.line}`,e.append(d)}}else{const s=document.createElement("span");s.classList.add("phpdebugbar-text-muted"),s.textContent=`${y}:`,e.append(s),e.append("\xA0");const d=document.createElement("span");d.classList.add("phpdebugbar-text-muted"),d.textContent=r,e.append(d.innerHTML)}i.append(e)}p+=u?` <i class="phpdebugbar-fa phpdebugbar-fa-${u} phpdebugbar-text-muted"></i>`:"";const E=document.createElement("tr"),c=document.createElement("td");c.classList.add(t("name")),c.innerHTML=p,E.append(c);const _=document.createElement("td");return _.classList.add(t("value")),_.append(i),E.append(_),E}render(){this.status=document.createElement("div"),this.status.classList.add(t("status")),this.el.append(this.status),this.toolbar=document.createElement("div"),this.toolbar.classList.add(t("toolbar")),this.el.append(this.toolbar);let p=[];const u=this;this.list=new PhpDebugBar.Widgets.ListWidget({itemRenderer(f,i){if(i.slow&&f.classList.add(t("sql-slow")),i.width_percent){const c=document.createElement("div");c.classList.add(t("bg-measure"));const _=document.createElement("div");_.classList.add(t("value")),_.style.left=`${i.start_percent}%`,_.style.width=`${Math.max(i.width_percent,.01)}%`,c.append(_),f.append(c)}if(i.duration_str){const c=document.createElement("span");c.setAttribute("title","Duration"),c.classList.add(t("duration")),c.textContent=i.duration_str,f.append(c)}if(i.memory_str){const c=document.createElement("span");c.setAttribute("title","Memory usage"),c.classList.add(t("memory")),c.textContent=i.memory_str,f.append(c)}if(typeof i.row_count!="undefined"){const c=document.createElement("span");c.setAttribute("title","Row count"),c.classList.add(t("row-count")),c.textContent=i.row_count,f.append(c)}if(typeof i.stmt_id!="undefined"&&i.stmt_id){const c=document.createElement("span");c.setAttribute("title","Prepared statement ID"),c.classList.add(t("stmt-id")),c.textContent=i.stmt_id,f.append(c)}if(i.connection){const c=document.createElement("span");if(c.setAttribute("title","Connection"),c.classList.add(t("database")),c.textContent=i.connection,f.append(c),f.setAttribute("connection",i.connection),!p.includes(i.connection)){p.push(i.connection);const _=document.createElement("a");_.classList.add(t("filter")),_.textContent=i.connection,_.setAttribute("rel",i.connection),_.addEventListener("click",function(){u.onFilterClick(this)}),u.toolbar.append(_),p.length>1&&(u.toolbar.style.display="",u.list.el.style.marginBottom="20px")}}if(!i.type||i.type==="query"){const c=document.createElement("span");c.setAttribute("title","Copy to clipboard"),c.classList.add(t("copy-clipboard")),c.style.cursor="pointer",c.innerHTML="&#8203;",c.addEventListener("click",function(_){u.onCopyToClipboard(this),_.stopPropagation()}),f.append(c)}if(typeof i.xdebug_link!="undefined"&&i.xdebug_link){const c=document.createElement("span");c.setAttribute("title","Filename"),c.classList.add(t("filename")),c.textContent=i.xdebug_link.filename+(i.xdebug_link.line?`#${i.xdebug_link.line}`:"");const _=document.createElement("a");_.setAttribute("href",i.xdebug_link.url),_.classList.add(t("editor-link")),_.addEventListener("click",y=>{y.stopPropagation(),i.xdebug_link.ajax&&(fetch(i.xdebug_link.url),y.preventDefault())}),c.append(_),f.append(c)}if(i.type==="transaction"){const c=document.createElement("strong");c.classList.add(t("sql"),t("name")),c.textContent=i.sql,f.append(c)}else{const c=document.createElement("code");c.classList.add(t("sql")),c.innerHTML=PhpDebugBar.Widgets.highlight(i.sql,"sql"),f.append(c)}if(typeof i.is_success!="undefined"&&!i.is_success){f.classList.add(t("error"));const c=document.createElement("span");c.classList.add(t("error")),c.textContent=`[${i.error_code}] ${i.error_message}`,f.append(c)}const E=document.createElement("table");E.classList.add(t("params")),i.params&&Object.keys(i.params).length>0&&E.append(u.renderList("Params","thumb-tack",i.params)),i.bindings&&Object.keys(i.bindings).length>0&&E.append(u.renderList("Bindings","thumb-tack",i.bindings)),i.hints&&Object.keys(i.hints).length>0&&E.append(u.renderList("Hints","question-circle",i.hints)),i.backtrace&&Object.keys(i.backtrace).length>0&&E.append(u.renderList("Backtrace","list-ul",i.backtrace)),E.querySelectorAll("tr").length&&(f.append(E),f.style.cursor="pointer",f.addEventListener("click",()=>{if(window.getSelection().type==="Range")return"";E.style.display!=="none"?E.style.display="none":E.style.display=""}))}}),this.el.append(this.list.el),this.bindAttr("data",function(f){if(f.length<=0||!f.statements)return!1;p=[],this.toolbar.style.display="none";const i=this.toolbar.querySelectorAll(`.${t("filter")}`);for(const y of i)y.remove();this.list.set("data",f.statements),this.status.innerHTML="";const E={};let c=0;for(let y=0;y<f.statements.length;y++){if(f.statements[y].type&&f.statements[y].type!=="query")continue;let r=f.statements[y].sql;f.statements[y].params&&Object.keys(f.statements[y].params).length>0&&(r+=JSON.stringify(f.statements[y].params)),f.statements[y].bindings&&Object.keys(f.statements[y].bindings).length>0&&(r+=JSON.stringify(f.statements[y].bindings)),f.statements[y].connection&&(r+=`@${f.statements[y].connection}`),E[r]=E[r]||{keys:[]},E[r].keys.push(y)}for(const y in E)if(E[y].keys.length>1){c+=E[y].keys.length;for(let r=0;r<E[y].keys.length;r++){const e=this.list.el.querySelectorAll(`.${t("list-item")}`);e[E[y].keys[r]]&&e[E[y].keys[r]].classList.add(t("sql-duplicate"))}}const _=document.createElement("span");if(_.textContent=`${f.nb_statements} statements were executed`,this.status.append(_),f.nb_failed_statements&&_.append(`, ${f.nb_failed_statements} of which failed`),c){_.append(`, ${c} of which were duplicates`),_.append(`, ${f.nb_statements-c} unique. `);const y="Show only duplicated",r=document.createElement("a");r.classList.add(t("duplicates")),r.textContent=y,r.addEventListener("click",function(){this.classList.toggle("shown-duplicated"),this.textContent=this.classList.contains("shown-duplicated")?"Show All":y;const e=`.${u.className} .${t("list-item")}:not(.${t("sql-duplicate")})`,s=document.querySelectorAll(e);for(const d of s)d.style.display=d.style.display==="none"?"":"none"}),_.append(r)}if(f.accumulated_duration_str){const y=document.createElement("span");y.setAttribute("title","Accumulated duration"),y.classList.add(t("duration")),y.textContent=f.accumulated_duration_str,this.status.append(y)}if(f.memory_usage_str){const y=document.createElement("span");y.setAttribute("title","Memory usage"),y.classList.add(t("memory")),y.textContent=f.memory_usage_str,this.status.append(y)}})}}PhpDebugBar.Widgets.SQLQueriesWidget=k})();(function(){const t=PhpDebugBar.utils.makecsscls("phpdebugbar-widgets-");class k extends PhpDebugBar.Widget{get className(){return t("templates")}render(){this.status=document.createElement("div"),this.status.classList.add(t("status")),this.el.append(this.status),this.list=new PhpDebugBar.Widgets.ListWidget({itemRenderer(p,u){const f=document.createElement("span");if(f.classList.add(t("name")),u.html?f.innerHTML=u.html:f.textContent=u.name,p.append(f),typeof u.xdebug_link!="undefined"&&u.xdebug_link!==null){const i=document.createElement("span");if(i.classList.add(t("filename")),i.textContent=u.xdebug_link.filename+(u.xdebug_link.line?`#${u.xdebug_link.line}`:""),u.xdebug_link){const E=document.createElement("a");E.setAttribute("href",u.xdebug_link.url),E.classList.add(t("editor-link")),E.addEventListener("click",c=>{c.stopPropagation(),u.xdebug_link.ajax&&(fetch(u.xdebug_link.url),c.preventDefault())}),i.append(E)}p.append(i)}if(u.render_time_str){const i=document.createElement("span");i.setAttribute("title","Render time"),i.classList.add(t("render-time")),i.textContent=u.render_time_str,p.append(i)}if(u.memory_str){const i=document.createElement("span");i.setAttribute("title","Memory usage"),i.classList.add(t("memory")),i.textContent=u.memory_str,p.append(i)}if(typeof u.param_count!="undefined"){const i=document.createElement("span");i.setAttribute("title","Parameter count"),i.classList.add(t("param-count")),i.textContent=u.param_count,p.append(i)}if(typeof u.type!="undefined"&&u.type){const i=document.createElement("span");i.setAttribute("title","Type"),i.classList.add(t("type")),i.textContent=u.type,p.append(i)}if(typeof u.editorLink!="undefined"&&u.editorLink){const i=document.createElement("a");i.setAttribute("href",u.editorLink),i.classList.add(t("editor-link")),i.textContent="file",i.addEventListener("click",E=>{E.stopPropagation()}),p.append(i)}if(u.params&&Object.keys(u.params).length>0){const i=document.createElement("table");i.classList.add(t("params")),i.innerHTML='<tr><th colspan="2">Params</th></tr>';for(const E in u.params)if(typeof u.params[E]!="function"){const c=document.createElement("tr");c.innerHTML=`<td class="${t("name")}">${E}</td><td class="${t("value")}"><pre><code>${u.params[E]}</code></pre></td>`,i.append(c)}p.append(i),p.style.cursor="pointer",p.addEventListener("click",()=>{if(window.getSelection().type==="Range")return"";i.style.display!=="none"?i.style.display="none":i.style.display=""})}}}),this.el.append(this.list.el),this.callgraph=document.createElement("div"),this.callgraph.classList.add(t("callgraph")),this.el.append(this.callgraph),this.bindAttr("data",function(p){this.list.set("data",p.templates),this.status.innerHTML="",this.callgraph.innerHTML="";const u=p.sentence||"templates were rendered",f=document.createElement("span");if(f.textContent=`${p.nb_templates} ${u}`,this.status.append(f),p.accumulated_render_time_str){const i=document.createElement("span");i.setAttribute("title","Accumulated render time"),i.classList.add(t("render-time")),i.textContent=p.accumulated_render_time_str,this.status.append(i)}if(p.memory_usage_str){const i=document.createElement("span");i.setAttribute("title","Memory usage"),i.classList.add(t("memory")),i.textContent=p.memory_usage_str,this.status.append(i)}if(p.nb_blocks>0){const i=document.createElement("div");i.textContent=`${p.nb_blocks} blocks were rendered`,this.status.append(i)}if(p.nb_macros>0){const i=document.createElement("div");i.textContent=`${p.nb_macros} macros were rendered`,this.status.append(i)}typeof p.callgraph!="undefined"&&(this.callgraph.innerHTML=p.callgraph)})}}PhpDebugBar.Widgets.TemplatesWidget=k})();(function(){const t=PhpDebugBar.utils.makecsscls("phpdebugbar-widgets-");class k extends PhpDebugBar.Widget{get className(){return t("mails")}render(){this.list=new PhpDebugBar.Widgets.ListWidget({itemRenderer(p,u){const f=document.createElement("span");f.classList.add(t("subject")),f.textContent=u.subject,p.append(f);const i=document.createElement("span");if(i.classList.add(t("to")),i.textContent=u.to,p.append(i),u.body||u.html){const E=document.createElement("span");E.classList.add(t("filename")),E.textContent="";const c=document.createElement("a");c.setAttribute("title","Mail Preview"),c.textContent="View Mail",c.classList.add(t("editor-link")),c.addEventListener("click",()=>{const y=window.open("about:blank","Mail Preview","width=650,height=440,scrollbars=yes").document;let r="";if(u.headers){const L=document.createElement("pre");L.style.border="1px solid #ddd",L.style.padding="5px";const g=document.createElement("code");g.textContent=u.headers,L.append(g),r=L.outerHTML}const e=document.createElement("pre");e.style.border="1px solid #ddd",e.style.padding="5px",e.textContent=u.body;let s=e.outerHTML,d="";if(u.html){const L=document.createElement("details"),g=document.createElement("summary");g.textContent="Text version",L.append(g),L.append(e),s=L.outerHTML;const n=document.createElement("iframe");n.setAttribute("width","100%"),n.setAttribute("height","400px"),n.setAttribute("sandbox",""),n.setAttribute("referrerpolicy","no-referrer"),n.setAttribute("srcdoc",u.html),d=n.outerHTML}y.open(),y.write(r+s+d),y.close()}),E.append(c),p.append(E)}if(u.headers){const E=document.createElement("pre");E.classList.add(t("headers"));const c=document.createElement("code");c.textContent=u.headers,E.append(c),p.append(E),p.addEventListener("click",()=>{E.style.display!=="none"?E.style.display="none":E.style.display=""})}}}),this.el.append(this.list.el),this.bindAttr("data",function(p){this.list.set("data",p)})}}PhpDebugBar.Widgets.MailsWidget=k})();})();
